KISSY.add("brix/gallery/kwicks/index",function(t,e){function n(){n.superclass.constructor.apply(this,arguments)}return n.ATTRS={isVertical:{value:!1},sticky:{value:!1},activeIndex:{value:0},trigger:{value:"li"},triggerType:{value:"mouseenter"},activeCls:{value:"active"},spacing:{value:0},duration:{value:.3},easing:{value:"easeNone"},max:{value:!1},min:{value:!1},autoplay:{value:!1},interval:{value:3e3}},n.EVENTS={"":{mouseenter:function(){var t=this,e=t.get("autoplay");e&&t.stop()},mouseleave:function(){var t=this,e=t.get("autoplay"),n=t.get("sticky");if(e)t.start();else if(!n){var r=t.kwicks,i=r.length,a=t.get("activeCls"),o=t.get("spacing"),u=t.get("duration"),s=t.get("easing"),l=t.LoT,c=t.WoH,f=t.normWoH;r.stop().removeClass(a),r.each(function(t,e){var n={};n[c]=f,i>e&&(n[l]=e*f+e*o),t.animate(n,u,s)})}}}},n.FIRES={beforeSwitchTo:"beforeSwitch","switch":"switch"},n.METHODS={switchTo:function(e){if(this.fire(n.FIRES.beforeSwitch,{toIndex:e})!==!1){var r=this,i=r.kwicks,a=i.length,o=r.preCalcLoTs,u=r.get("activeCls"),s=r.get("duration"),l=r.get("easing"),c=r.LoT,f=r.WoH,h=r.max,d=r.min;e>=a||0>e?(e=0,r.set("activeIndex",0)):r.set("activeIndex",e);var g=i.item(e);i.stop().removeClass(u),g.addClass(u);var p=0;i.each(function(i,u){var v={};v[f]=g[0]==i[0]?h:d,v[c]=o[e][u],i.animate(v,s,l,function(){p++,p==a&&(t.log("fire switch"),r.fire(n.FIRES["switch"],{currentIndex:e}))})})}},start:function(){var e=this,n=e.get("autoplay"),r=e.get("interval");n&&(e.stop(),e.timer=t.later(function(){var t=e.get("activeIndex");e.switchTo(t+1)},r,!0,e))},stop:function(){var t=this;t.timer&&(t.timer.cancel(),t.timer=null)}},t.extend(n,e,{initialize:function(){var t=this,e=t.get("isVertical"),n=t.get("sticky"),r=t.get("activeIndex"),i=t.get("triggerType"),a=t.get("activeCls"),o=t.get("spacing"),u=(t.get("duration"),t.get("easing"),t.max=t.get("max")),s=t.min=t.get("min");t.get("autoplay");var l=t.WoH=e?"height":"width",c=t.LoT=e?"top":"left",f=t.get("el"),h=t.kwicks=f.all(t.get("trigger")),d=h.length,g=t.normWoH=h.item(0).css(l).replace(/px/,"");u?s=t.min=(g*d-u)/(d-1):u=t.max=g*d-s*(d-1),e?f.css({width:h.item(0).css("width"),height:g*d+o*(d-1)+"px"}):f.css({width:g*d+o*(d-1)+"px",height:h.item(0).css("height")});for(var p=t.preCalcLoTs=[],v=0;d>v;v++){p[v]=[];for(var m=0;d>m;m++)p[v][m]=v==m?e?m*s+m*o:m*s+m*o:(v>m?m*s:(m-1)*s+u)+m*o}h.each(function(e,f){n?e.css(c,p[r][f]):e.css(c,f*g+f*o),n&&(r==f?(e.css(l,u+"px"),e.addClass(a)):e.css(l,s+"px")),e.css({margin:0,position:"absolute"}),e.on(i,function(){t.switchTo(f)})}),t.start()},destructor:function(){self.timer&&(self.timer.cancel(),self.timer=null,self.kwicks=null)}}),t.augment(n,n.METHODS),n},{requires:["brix/core/brick"]});