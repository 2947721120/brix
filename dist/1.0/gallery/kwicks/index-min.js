KISSY.add("brix/gallery/kwicks/index",function(e,t){function i(){i.superclass.constructor.apply(this,arguments)}return i.ATTRS={isVertical:{value:!1},sticky:{value:!1},activeIndex:{value:0},trigger:{value:"li"},triggerType:{value:"mouseenter"},activeCls:{value:"active"},spacing:{value:0},duration:{value:.3},easing:{value:"easeNone"},max:{value:!1},min:{value:!1},autoplay:{value:!1},interval:{value:3e3}},i.EVENTS={"":{mouseenter:function(){var e=this,t=e.get("autoplay");t&&e.stop()},mouseleave:function(){var e=this,t=e.get("autoplay"),i=e.get("sticky");if(t)e.start();else if(!i){var n=e.kwicks,a=n.length,r=e.get("activeCls"),o=e.get("spacing"),s=e.get("duration"),l=e.get("easing"),c=e.LoT,u=e.WoH,d=e.normWoH;n.stop().removeClass(r),n.each(function(e,t){var i={};i[u]=d,a>t&&(i[c]=t*d+t*o),e.animate(i,s,l)})}}}},i.FIRES={beforeSwitchTo:"beforeSwitch","switch":"switch"},i.METHODS={switchTo:function(t){if(this.fire(i.FIRES.beforeSwitch,{toIndex:t})!==!1){var n=this,a=n.kwicks,r=a.length,o=n.preCalcLoTs,s=n.get("activeCls"),l=n.get("duration"),c=n.get("easing"),u=n.LoT,d=n.WoH,p=n.max,f=n.min;t>=r||0>t?(t=0,n.set("activeIndex",0)):n.set("activeIndex",t);var h=a.item(t);a.stop().removeClass(s),h.addClass(s);var g=0;a.each(function(a,s){var v={};v[d]=h[0]==a[0]?p:f,v[u]=o[t][s],a.animate(v,l,c,function(){g++,g==r&&(e.log("fire switch"),n.fire(i.FIRES["switch"],{currentIndex:t}))})})}},start:function(){var t=this,i=t.get("autoplay"),n=t.get("interval");i&&(t.stop(),t.timer=e.later(function(){var e=t.get("activeIndex");t.switchTo(e+1)},n,!0,t))},stop:function(){var e=this;e.timer&&(e.timer.cancel(),e.timer=null)}},e.extend(i,t,{initialize:function(){var e=this,t=e.get("isVertical"),i=e.get("sticky"),n=e.get("activeIndex"),a=e.get("triggerType"),r=e.get("activeCls"),o=e.get("spacing"),s=(e.get("duration"),e.get("easing"),e.max=e.get("max")),l=e.min=e.get("min");e.get("autoplay");var c=e.WoH=t?"height":"width",u=e.LoT=t?"top":"left",d=e.get("el"),p=e.kwicks=d.all(e.get("trigger")),f=p.length,h=e.normWoH=p.item(0).css(c).replace(/px/,"");s?l=e.min=(h*f-s)/(f-1):s=e.max=h*f-l*(f-1),t?d.css({width:p.item(0).css("width"),height:h*f+o*(f-1)+"px"}):d.css({width:h*f+o*(f-1)+"px",height:p.item(0).css("height")});for(var g=e.preCalcLoTs=[],v=0;f>v;v++){g[v]=[];for(var m=0;f>m;m++)g[v][m]=v==m?t?m*l+m*o:m*l+m*o:(v>m?m*l:(m-1)*l+s)+m*o}p.each(function(t,d){i?t.css(u,g[n][d]):t.css(u,d*h+d*o),i&&(n==d?(t.css(c,s+"px"),t.addClass(r)):t.css(c,l+"px")),t.css({margin:0,position:"absolute"}),t.on(a,function(){e.switchTo(d)})}),e.start()},destructor:function(){self.timer&&(self.timer.cancel(),self.timer=null,self.kwicks=null)}}),e.augment(i,i.METHODS),i},{requires:["brix/core/brick"]});