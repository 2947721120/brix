KISSY.add("brix/gallery/dialog/index",function(t,e,n){function r(){var e=this;r.superclass.constructor.apply(this,arguments);var e=this,n=t.one(e.get("trigger"));if(n){var i=e.get("triggerType");t.each(i,function(t){n.on(t,e.toggle,e)})}}return r.ATTRS={trigger:{value:!1},triggerType:{value:["click"]},start:{},end:{},elCls:{value:"dialog"},prefixCls:{value:"dialog-"},x:{getter:function(){var t=this;return t.get("start")?t.get("start").left:!1}},y:{getter:function(){var t=this;return t.get("start")?t.get("start").top:!1}},dir:{getter:function(){var t=this,e="",n=t.get("start"),r=t.get("end");return n.left===r.left&&n.top===r.top?!1:e=n.left===r.left&&(n.top<r.top?"down":"up")||n.top===r.top&&(n.left<r.left?"right":"left")||"left"}},duration:{value:.3},easing:{value:"easeNone"},closable:{value:!0},mask:{value:!1},tmpl:{value:null},data:{}},t.extend(r,n,{initializer:function(){var t=this;t.on("afterRenderUI",function(){var n=t.get("el").one(".dialog-ext-close");n.one(".dialog-ext-close-x").html("&#223"),n.on("mouseenter",function(){n.one(".dialog-ext-close-x").html("&#378")}),n.on("mouseleave",function(){n.one(".dialog-ext-close-x").html("&#223")}),t.get("tmpl")&&(t.pagelet=new e({container:t.get("contentEl"),tmpl:t.get("tmpl"),data:t.get("data")}))})},_visibilityChange:function(e,n){var r=this,i=r.get("el"),a=t.one("body"),o=t.one("html"),u="start";r.get("dir"),i.stop(),a.css({width:a.width(),height:a.height(),overflow:"hidden"}),o.css({width:a.width(),height:a.height(),overflow:"hidden"}),i.css("visibility","visible"),e?(i.css(r.get("start")),u="end"):(i.css(r.get("end")),u="start"),i.animate(r.get(u),r.get("duration"),r.get("easing"),function(){i.css("visibility",e?"visible":"hidden"),e||i.css({left:"-99999px",top:"-99999px"}),a.css({width:"",height:"",overflow:""}),o.css({width:"",height:"",overflow:""}),n&&n.call(r)})},bindUI:function(){var t=this,e=t.get("el");t.on("beforeVisibleChange",function(n){if(!t.get("start"))return!0;var r=n.newVal,i=t.get("dir");return e.removeClass("dialog-left").removeClass("dialog-right").removeClass("dialog-up").removeClass("dialog-down"),i&&e.addClass("dialog-"+i),r?void 0:(t._visibilityChange(r,function(){e.css("visibility","hidden"),t.set("visible",!1,{silent:!0}),t.fire("hide")}),!1)}),t.on("afterVisibleChange",function(e){if(!t.get("start"))return!0;var n=e.newVal;n&&t._visibilityChange(n)})},destructor:function(){var e=this,n=t.one(e.get("trigger"));if(n){var r=e.get("triggerType");t.each(r,function(t){n.detach(t,e.toggle,e)})}e.pagelet&&(e.pagelet.destroy(),e.pagelet=null)},toggle:function(t){var e=this;t&&t.preventDefault();var e=this,n=e.get("el");n?"hidden"==n.css("visibility")?e.show():e.hide():e.show()}}),r},{requires:["brix/core/pagelet","overlay"]});