KISSY.add("brix/gallery/dialog/index",function(a,b,c){function d(b){var c=this;d.superclass.constructor.apply(this,arguments);var c=this,e=a.one(c.get("trigger"));if(e){var f=c.get("triggerType");a.each(f,function(a){e.on(a,c.toggle,c)})}}return d.ATTRS={trigger:{value:!1},triggerType:{value:["click"]},start:{},end:{},elCls:{value:"dialog"},prefixCls:{value:"dialog-"},x:{getter:function(){var a=this;return a.get("start")?a.get("start").left:!1}},y:{getter:function(){var a=this;return a.get("start")?a.get("start").top:!1}},dir:{getter:function(){var a=this,b="",c=a.get("start"),d=a.get("end");return c.left===d.left&&c.top===d.top?!1:(b=c.left===d.left&&(c.top<d.top?"down":"up")||c.top===d.top&&(c.left<d.left?"right":"left")||"left",b)}},duration:{value:.3},easing:{value:"easeNone"},closable:{value:!0},mask:{value:!1},tmpl:{value:null},data:{}},a.extend(d,c,{initializer:function(){var a=this;a.on("afterRenderUI",function(){var c=a.get("el").one(".dialog-ext-close");c.one(".dialog-ext-close-x").html("&#223"),c.on("mouseenter",function(a){c.one(".dialog-ext-close-x").html("&#378")}),c.on("mouseleave",function(a){c.one(".dialog-ext-close-x").html("&#223")}),a.get("tmpl")&&(a.pagelet=new b({container:a.get("contentEl"),tmpl:a.get("tmpl"),data:a.get("data")}))})},_visibilityChange:function(b,c){var d=this,e=d.get("el"),f=a.one("body"),g=a.one("html"),h="start",i=d.get("dir");e.stop(),f.css({width:f.width(),height:f.height(),overflow:"hidden"}),g.css({width:f.width(),height:f.height(),overflow:"hidden"}),e.css("visibility","visible"),b?(e.css(d.get("start")),h="end"):(e.css(d.get("end")),h="start"),e.animate(d.get(h),d.get("duration"),d.get("easing"),function(){e.css("visibility",b?"visible":"hidden"),b||e.css({left:"-99999px",top:"-99999px"}),f.css({width:"",height:"",overflow:""}),g.css({width:"",height:"",overflow:""}),c&&c.call(d)})},bindUI:function(){var a=this,b=a.get("el");a.on("beforeVisibleChange",function(c){if(!a.get("start"))return!0;var d=c.newVal,e=a.get("dir");b.removeClass("dialog-left").removeClass("dialog-right").removeClass("dialog-up").removeClass("dialog-down"),e&&b.addClass("dialog-"+e);if(!d)return a._visibilityChange(d,function(){b.css("visibility","hidden"),a.set("visible",!1,{silent:!0}),a.fire("hide")}),!1}),a.on("afterVisibleChange",function(b){if(!a.get("start"))return!0;var c=b.newVal;c&&a._visibilityChange(c)})},destructor:function(){var b=this,c=a.one(b.get("trigger"));if(c){var d=b.get("triggerType");a.each(d,function(a){c.detach(a,b.toggle,b)})}b.pagelet&&(b.pagelet.destroy(),b.pagelet=null)},toggle:function(a){var b=this;a&&a.preventDefault();var b=this,c=b.get("el");c?c.css("visibility")=="hidden"?b.show():b.hide():b.show()}}),d},{requires:["brix/core/pagelet","overlay"]});