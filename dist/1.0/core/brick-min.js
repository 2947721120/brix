KISSY.add("brix/core/brick",function(e,t){function r(t,r){return e.isString(r)?t[r]:r}function n(){var e=this;e.pagelet=arguments[0]?arguments[0].pagelet:null,n.superclass.constructor.apply(this,arguments);for(var t=e.constructor;"Brick"!=t.NAME;){var r=t.RENDERERS;r&&(e._buildTmpler("",!1),e._buildDataset(),e.get("dataset").setRenderer(r,e)),t=t.superclass.constructor}e.on("rendered",function(){var r,n=[];for(t=e.constructor;"Brick"!=t.NAME;)t.prototype.hasOwnProperty("initialize")&&(r=t.prototype.initialize)&&n.push(r),t=t.superclass.constructor;for(var a=n.length-1;a>=0;a--)n[a]&&n[a].call(e);e._bindEvent()});var a=e.get("tmpler");(e.get("autoRender")||!a||a.inDom)&&e.render()}return n.NAME="Brick",e.extend(n,t,{initialize:function(){},destructor:function(){},_detachEvent:function(){for(var t=this,r=t.constructor;"Brick"!=r.NAME;){var n=r.EVENTS;n&&t._removeEvents(n);var a=r.DOCEVENTS;a&&t._removeEvents(a,e.one(document)),r=r.superclass.constructor}t._undelegateEvents();var i=t.get("events");i&&this._removeEvents(i)},_bindEvent:function(){for(var t=this,r=t.constructor;"Brick"!=r.NAME;){var n=r.EVENTS;n&&this._addEvents(n);var a=r.DOCEVENTS;a&&this._addEvents(a,e.one(document)),r=r.superclass.constructor}t._delegateEvents();var i=t.get("events");i&&this._addEvents(i)},_removeEvents:function(e,t){t=t||this.get("el");for(var n in e){var a=e[n];for(var i in a){var o=r(this,a[i]);""===n?t.detach(i,o,this):t.undelegate(i,n,o,this)}}},_addEvents:function(e,t){t=t||this.get("el");for(var n in e){var a=e[n];for(var i in a){var o=r(this,a[i]);""===n?t.on(i,o,this):t.delegate(i,n,o,this)}}},_delegateEvents:function(){var e=this.events,t=this.get("el")[0],r=this,n=function(e){t["on"+e]=function(){var t=arguments[0]||window.event,n=t.target||t.srcElement;1!==n.nodeType&&(n=n.parentNode);var a=n.getAttribute("bx"+e);if(a)for(var i,o,l=a.split("|"),s=0;l.length>s;s++){i=l[s].split(":"),o=i.shift();var u=i[i.length-1],c=!1;("_halt_"===u||"_preventDefault_"===u)&&(t.preventDefault?t.preventDefault():t.returnValue=!1,c=!0),("_halt_"===u||"_stop_"===u)&&(t.stopPropagation?t.stopPropagation():t.cancelBubble=!0,c=!0),c&&i.pop(),r.events&&r.events[e]&&r.events[e][o]&&r.events[e][o].call(r,n,i)}n=null}};for(var a in e)n(a)},_undelegateEvents:function(){var e=this.events,t=this.get("el")[0],r=function(e){t["on"+e]=null};for(var n in e)r(n)},destroy:function(){var e=this;e._destroy(),e.get("rendered")&&e._detachEvent();for(var t=e.constructor;"Brick"!=t.NAME;)t.prototype.hasOwnProperty("destructor")&&t.prototype.destructor.apply(e),t=t.superclass.constructor;if(e.get("rendered")&&e.get("isRemoveHTML")){var r=e.get("el");e.get("isRemoveEl")?r.remove():r.empty()}e.pagelet&&delete e.pagelet,e.detach()}}),n},{requires:["./chunk"]});