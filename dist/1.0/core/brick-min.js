KISSY.add("brix/core/brick",function(a,b){function c(b,c){return a.isString(c)?b[c]:c}function d(){var a=this;a.pagelet=arguments[0]?arguments[0].pagelet:null,d.superclass.constructor.apply(this,arguments);var b=a.get("tmpler"),c=a.constructor;if(b)while(c.NAME!="Brick"){var e=c.RENDERERS;e&&a.get("dataset").setRenderer(e,a),c=c.superclass.constructor}a.on("rendered",function(){var b,d=[];c=a.constructor;while(c.NAME!="Brick")c.prototype.hasOwnProperty("initialize")&&(b=c.prototype.initialize)&&d.push(b),c=c.superclass.constructor;for(var e=d.length-1;e>=0;e--)d[e]&&d[e].call(a);a._bindEvent()}),(a.pagelet||a.get("autoRender")||!b||b.inDom)&&a.render()}return d.NAME="Brick",a.extend(d,b,{initialize:function(){},destructor:function(){},_detachEvent:function(){var b=this,c=b.constructor;while(c.NAME!="Brick"){var d=c.EVENTS;d&&b._removeEvents(d);var e=c.DOCEVENTS;e&&b._removeEvents(e,a.one(document)),c=c.superclass.constructor}b._undelegateEvents();var f=b.get("events");f&&this._removeEvents(f)},_bindEvent:function(){var b=this,c=b.constructor;while(c.NAME!="Brick"){var d=c.EVENTS;d&&this._addEvents(d);var e=c.DOCEVENTS;e&&this._addEvents(e,a.one(document)),c=c.superclass.constructor}b._delegateEvents();var f=b.get("events");f&&this._addEvents(f)},_removeEvents:function(a,b){b=b||this.get("el");for(var d in a){var e=a[d];for(var f in e){var g=c(this,e[f]);d===""?b.detach(f,g,this):b.undelegate(f,d,g,this)}}},_addEvents:function(a,b){b=b||this.get("el");for(var d in a){var e=a[d];for(var f in e){var g=c(this,e[f]);d===""?b.on(f,g,this):b.delegate(f,d,g,this)}}},_delegateEvents:function(){var a=this.events,b=this.get("el")[0],c=this;for(var d in a)(function(){var a=d;b["on"+a]=function(){var b=arguments[0]||window.event,d=b.target||b.srcElement;d.nodeType!==1&&(d=d.parentNode);var e=d.getAttribute("bx"+a);if(e){var f=e.split("|"),g,h;for(var i=0;i<f.length;i++){g=f[i].split(":"),h=g.shift();var j=g[g.length-1],k=!1;if(j==="_halt_"||j==="_preventDefault_")b.preventDefault?b.preventDefault():b.returnValue=!1,k=!0;if(j==="_halt_"||j==="_stop_")b.stopPropagation?b.stopPropagation():b.cancelBubble=!0,k=!0;k&&g.pop(),c.events&&c.events[a]&&c.events[a][h]&&c.events[a][h].call(c,d,g)}}d=null}})()},_undelegateEvents:function(){var a=this.events,b=this.get("el")[0],c=this;for(var d in a)(function(){var a=d;b["on"+a]=null})()},destroy:function(){var a=this;a._destroy(),a.get("rendered")&&a._detachEvent();var b=a.constructor;while(b.NAME!="Brick")b.prototype.hasOwnProperty("destructor")&&b.prototype.destructor.apply(a),b=b.superclass.constructor;if(a.get("rendered")&&a.get("isRemoveHTML")){var c=a.get("el");a.get("isRemoveEl")?c.remove():c.empty()}a.pagelet&&delete a.pagelet,a.detach()}}),d},{requires:["./chunk"]});