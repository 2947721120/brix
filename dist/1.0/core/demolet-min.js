KISSY.add("brix/core/demolet",function(a,b,c,d){function g(a){if(f[a])return!1;f[a]=!0,c({url:a,dataType:"text",async:!1,complete:function(a,b,c){b=="success"&&e("<style>"+a+"</style>").appendTo("head")}})}function h(a,b,d){d=d||"@",b=b||{};var e=new RegExp("\\{\\{"+d+"(.+)?\\}\\}","ig");return a=a.replace(e,function(a,d){var e="",f=d.replace(/\//ig,"_").replace(/\./ig,"_");return b[f]=b[f]||{},c({url:d+"template.html",dataType:"html",async:!1,success:function(a,b,c){e="{{#"+f+"}}"+a+"{{/"+f+"}}"}}),c({url:d+"data.json",async:!1,dataType:"json",success:function(a,c,d){for(var e in a)b[f][e]=a[e]}}),e}),{tmpl:a,data:b}}function i(){var b=this;b.on("beforeAddBehavior",function(c){a.each(b.get("projectCss"),function(a){g(a)});var d=c.useList;a.each(d,function(b){var c=b.split("/");if(a.startsWith(b,"brix/"))a.use(b+c[c.length-2]+".css");else{var d=3;a.startsWith(b,"imports/")&&(d=4),c.length>d&&(c.splice(c.length-2),g(c.join("/")+"/index.css")),g(b+"index.css")}})}),i.superclass.constructor.apply(this,arguments)}var e=d.all,f={};return i.ATTRS={projectCss:{value:["styles/style.css"],setter:function(b){return a.isArray(b)?b:[b]}},s:{value:"@"},tmpl:{setter:function(a){var b=this,c=b.get("data")||{},d=h(a,c,b.get("s"));return b.set("data",d.data),d.tmpl}}},a.extend(i,b,{}),i},{requires:["./pagelet","ajax","node"]});