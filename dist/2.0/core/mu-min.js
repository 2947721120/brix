KISSY.add("brix/core/mu",function(a,b){function c(a,b){var c=d(a),f="";for(var g=0;g<c.length;g++){f="if("+c[g]+")";if(b[f])continue;b[f]=e(c[g])}}function d(a){var b=/\{{2,3}[\^#]?if\((.*?)\)\}{2,3}?/ig,c=/\{{2,3}[\^#]?if\((.*?)\)\}{2,3}?/i,d=a.match(b),e=[];if(d)for(var f=0;f<d.length;f++)e.push(d[f].match(c)[1]);return e}function e(a){a=a.split("==");var b=function(){var b=a[0].split("."),c=a[1],d=this;for(var e=b.length-1;e>-1;e--){var f=b.slice(e),g=d;try{for(var h=0;h<f.length-1;h++)g=g[f[h]];if(f[f.length-1]in g)return g[f[f.length-1]].toString()===c?!0:!1}catch(i){}}return!1};return b}function f(a,b){var c,d;for(c in a)d=a[c],d instanceof Array?g(d):typeof d=="object"&&b<5&&f(d,b+1)}function g(a){for(var b=0;b<a.length;b++){var c=a[b];typeof c=="object"&&(b===0?c.__first__=!0:b===a.length-1?c.__last__=!0:c.__mid__=!0,c.__index__=b)}}return{to_html:function(a,d){return typeof d=="object"&&f(d,0),a=a.replace(/(\{{2,3})@if/ig,"$1#if"),c(a,d),b.to_html.apply(this,arguments)},name:b.name,version:b.version,tags:b.tags,parse:b.parse,compile:b.compile,render:b.render,clearCache:b.clearCache}},{requires:["./mustache"]});