KISSY.add("brix/core/mustache",function(){var e="undefined"!=typeof module&&module.exports||{};return function(e){function n(e){return v.test(e)}function r(e){return(e+"").replace(/&(?!\w+;)|[<>"']/g,function(e){return k[e]||e})}function t(e,n,r,t){t=t||"<template>";for(var a,i=n.split("\n"),o=Math.max(r-3,0),u=Math.min(i.length,r+3),c=i.slice(o,u),f=0,l=c.length;l>f;++f)a=f+o+1,c[f]=(a===r?" >> ":"    ")+c[f];return e.template=n,e.line=r,e.file=t,e.message=[t+":"+r,c.join("\n"),"",e.message].join("\n"),e}function a(e,n,r){if("."===e)return n[n.length-1];for(var t,a,i,o,u=e.split("."),c=u.length-1,f=u[c],l=n.length;l;){for(o=n.slice(0),a=n[--l],i=0;c>i&&(a=a[u[i++]],null!=a);)o.push(a);if(a&&"object"==typeof a&&f in a){t=a[f];break}}return"function"==typeof t&&(t=t.call(o[o.length-1])),null==t?r:t}function i(e,n,r,t){var i="",o=a(e,n);if(t)(null==o||o===!1||s(o)&&0===o.length)&&(i+=r());else if(s(o))m(o,function(e){n.push(e),i+=r(),n.pop()});else if("object"==typeof o)n.push(o),i+=r(),n.pop();else if("function"==typeof o){var u=n[n.length-1],c=function(e){return l(e,u)};i+=o.call(u,r(),c)||""}else o&&(i+=r());return i}function o(r,a){a=a||{};for(var i,o,u,c,f,l=a.tags||e.tags,s=l[0],p=l[l.length-1],g=['var buffer = "";',"\nvar line = 1;","\ntry {",'\nbuffer += "'],b=[],h=!1,m=!1,v=function(){if(!h||m||a.space)b=[];else for(;b.length;)g.splice(b.pop(),1);h=!1,m=!1},y=[],x=function(e){l=d(e).split(/\s+/),o=l[0],u=l[l.length-1]},k=function(e){g.push('";',i,'\nvar partial = partials["'+d(e)+'"];',"\nif (partial) {","\n  buffer += render(partial,stack[stack.length - 1],partials);","\n}",'\nbuffer += "')},S=function(e,n){var o=d(e);if(""===o)throw t(Error("Section name may not be empty"),r,A,a.file);y.push({name:o,inverted:n}),g.push('";',i,'\nvar name = "'+o+'";',"\nvar callback = (function () {","\n  return function () {",'\n    var buffer = "";','\nbuffer += "')},w=function(e){S(e,!0)},E=function(e){var n=d(e),i=0!=y.length&&y[y.length-1].name;if(!i||n!=i)throw t(Error('Section named "'+n+'" was never opened'),r,A,a.file);var o=y.pop();g.push('";',"\n    return buffer;","\n  };","\n})();"),o.inverted?g.push("\nbuffer += renderSection(name,stack,callback,true);"):g.push("\nbuffer += renderSection(name,stack,callback);"),g.push('\nbuffer += "')},j=function(e){g.push('";',i,'\nbuffer += lookup("'+d(e)+'",stack,"");','\nbuffer += "')},P=function(e){g.push('";',i,'\nbuffer += escapeHTML(lookup("'+d(e)+'",stack,""));','\nbuffer += "')},A=1,O=0,_=r.length;_>O;++O)if(r.slice(O,O+s.length)===s){switch(O+=s.length,c=r.substr(O,1),i="\nline = "+A+";",o=s,u=p,h=!0,c){case"!":O++,f=null;break;case"=":O++,p="="+p,f=x;break;case">":O++,f=k;break;case"#":O++,f=S;break;case"^":O++,f=w;break;case"/":O++,f=E;break;case"{":p="}"+p;case"&":O++,m=!0,f=j;break;default:m=!0,f=P}var T=r.indexOf(p,O);if(-1===T)throw t(Error('Tag "'+s+'" was not closed properly'),r,A,a.file);var $=r.substring(O,T);f&&f($);for(var R=0;~(R=$.indexOf("\n",R));)A++,R++;O=T+p.length-1,s=o,p=u}else switch(c=r.substr(O,1)){case'"':case"\\":m=!0,g.push("\\"+c);break;case"\r":break;case"\n":b.push(g.length),g.push("\\n"),v(),A++;break;default:n(c)?b.push(g.length):m=!0,g.push(c)}if(0!=y.length)throw t(Error('Section "'+y[y.length-1].name+'" was not closed properly'),r,A,a.file);v(),g.push('";',"\nreturn buffer;","\n} catch (e) { throw {error: e, line: line}; }");var F=g.join("").replace(/buffer \+= "";\n/g,"");return a.debug&&("undefined"!=typeof console&&console.log?console.log(F):"function"==typeof print&&print(F)),F}function u(e,n){var u="view,partials,stack,lookup,escapeHTML,renderSection,render",c=o(e,n),f=Function(u,c);return function(o,u){u=u||{};var c=[o];try{return f(o,u,c,a,r,i,l)}catch(s){throw t(s.error,e,s.line,n.file)}}}function c(){S={}}function f(e,n){return n=n||{},n.cache!==!1?(S[e]||(S[e]=u(e,n)),S[e]):u(e,n)}function l(e,n,r){return f(e)(n,r)}e.name="mustache.js",e.version="0.5.0-dev",e.tags=["{{","}}"],e.parse=o,e.compile=f,e.render=l,e.clearCache=c,e.to_html=function(e,n,r,t){var a=l(e,n,r);return"function"!=typeof t?a:(t(a),void 0)};var s,p=Object.prototype.toString,g=Array.isArray,b=Array.prototype.forEach,h=String.prototype.trim;s=g?g:function(e){return"[object Array]"===p.call(e)};var m;m=b?function(e,n,r){return b.call(e,n,r)}:function(e,n,r){for(var t=0,a=e.length;a>t;++t)n.call(r,e[t],t,e)};var d,v=/^\s*$/;if(h)d=function(e){return null==e?"":h.call(e)};else{var y,x;n("\u00a0")?(y=/^\s+/,x=/\s+$/):(y=/^[\s\xA0]+/,x=/[\s\xA0]+$/),d=function(e){return null==e?"":(e+"").replace(y,"").replace(x,"")}}var k={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},S={}}(e),e});