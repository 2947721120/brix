/*! Brix - v2.0
* https://github.com/etaoux/brix
* Copyright (c) 2013 etaoux; Licensed MIT */ 
(function(e,t){function r(e){return e?Function("return "+e)():{}}function n(){var t,n,i=/^(.*)(brix)(?:-min)?\.js[^\/]*/i,o=/(brix)(?:-min)?\.js/i,c=s.document.getElementsByTagName("script"),l=c[c.length-1],u=l.src,f=r(l.getAttribute("bx-config"));t=f.comboPrefix=f.comboPrefix||"??",n=f.comboSep=f.comboSep||",";var d,p,h=u.indexOf(t);return-1==h?p=u.replace(i,"$1"):(p=u.substring(0,h),"/"!=p.charAt(p.length-1)&&(p+="/"),d=u.substring(h+t.length).split(n),e.each(d,function(e){return e.match(o)?(p+=e.replace(i,"$1"),!1):void 0})),p=""+a.resolve(p),p=p.substring(0,p.lastIndexOf("brix")),e.mix({autoConfig:!0,base:p,componentsPath:"./",importsPath:"./",templateEngine:"./mu"},f)}var a,i=!1,o=[],s=e.Env.host;t=s[t]=s[t]||{},a=new e.Uri(s.location.href);var c=n(),l="",u="20121226",f="2.0",d=!1;return e.mix(t,{config:function(r){d||(d=!0,r=e.merge({debug:""===l?!1:!0,combine:!1,tag:"@TAG@"==u?"":u,fixed:"@VERSION@"==f?"src/":f+"/",gallery:{}},c,r),t.basePath=r.base,t.fixed=r.fixed,t.templateEngine=r.templateEngine,e.config({packages:[{name:"brix",base:r.base,combine:r.combine,debug:r.debug,tag:r.tag,charset:"utf-8"},{name:"components",base:r.componentsPath,combine:r.combine,debug:r.debug,tag:r.componentsTag||r.tag,charset:"utf-8"},{name:"imports",base:r.importsPath,combine:r.combine,debug:r.debug,tag:r.importsTag||r.tag,charset:"utf-8"}]}),e.config({map:[[/(.+brix\/)(gallery\/)(.+?)(\/.+?(?:-min)?\.(?:js|css))(\?[^?]+)?$/,function(e,t,n,a,i,o){var s=t+r.fixed+n+a;return r.gallery[a]&&(s+="/"+r.gallery[a]),s+=i+(o?o:"")}],[/(.+brix\/)(core.+?)((?:-min)?\.js)(\?[^?]+)?$/,function(e,t,n,a,i){var o=t+r.fixed;return o+=n+a+(i?i:"")}]]}))},ready:function(e){i?e.call(t):o.push(e)},_bx_fireReady:function(){if(!i&&(i=!0,o)){for(var e,r=0;e=o[r++];)e.call(t);o=null}},returnJSON:function(e){return r(e)},absoluteFilePath:function(t,r){return""+new e.Uri(t.getFullPath()).resolve(r)}}),c.autoConfig&&(t.config({}),c.autoPagelet)?(e.later(function(){e.use("brix/core/pagelet",function(e,r){e.ready(function(){t.pagelet=new r({tmpl:"body"}),t._bx_fireReady()})})},1),void 0):(e.ready(function(){t._bx_fireReady()}),void 0)})(KISSY,"Brix"),KISSY.add("brix/core/mustache",function(){var e="undefined"!=typeof module&&module.exports||{};return function(e){function t(e){return m.test(e)}function r(e){return(e+"").replace(/&(?!\w+;)|[<>"']/g,function(e){return _[e]||e})}function n(e,t,r,n){n=n||"<template>";for(var a,i=t.split("\n"),o=Math.max(r-3,0),s=Math.min(i.length,r+3),c=i.slice(o,s),l=0,u=c.length;u>l;++l)a=l+o+1,c[l]=(a===r?" >> ":"    ")+c[l];return e.template=t,e.line=r,e.file=n,e.message=[n+":"+r,c.join("\n"),"",e.message].join("\n"),e}function a(e,t,r){if("."===e)return t[t.length-1];for(var n,a,i,o,s=e.split("."),c=s.length-1,l=s[c],u=t.length;u;){for(o=t.slice(0),a=t[--u],i=0;c>i&&(a=a[s[i++]],null!=a);)o.push(a);if(a&&"object"==typeof a&&l in a){n=a[l];break}}return"function"==typeof n&&(n=n.call(o[o.length-1])),null==n?r:n}function i(e,t,r,n){var i="",o=a(e,t);if(n)(null==o||o===!1||f(o)&&0===o.length)&&(i+=r());else if(f(o))b(o,function(e){t.push(e),i+=r(),t.pop()});else if("object"==typeof o)t.push(o),i+=r(),t.pop();else if("function"==typeof o){var s=t[t.length-1],c=function(e){return u(e,s)};i+=o.call(s,r(),c)||""}else o&&(i+=r());return i}function o(r,a){a=a||{};for(var i,o,s,c,l,u=a.tags||e.tags,f=u[0],d=u[u.length-1],p=['var buffer = "";',"\nvar line = 1;","\ntry {",'\nbuffer += "'],h=[],v=!1,b=!1,m=function(){if(!v||b||a.space)h=[];else for(;h.length;)p.splice(h.pop(),1);v=!1,b=!1},y=[],x=function(e){u=g(e).split(/\s+/),o=u[0],s=u[u.length-1]},_=function(e){p.push('";',i,'\nvar partial = partials["'+g(e)+'"];',"\nif (partial) {","\n  buffer += render(partial,stack[stack.length - 1],partials);","\n}",'\nbuffer += "')},k=function(e,t){var o=g(e);if(""===o)throw n(Error("Section name may not be empty"),r,R,a.file);y.push({name:o,inverted:t}),p.push('";',i,'\nvar name = "'+o+'";',"\nvar callback = (function () {","\n  return function () {",'\n    var buffer = "";','\nbuffer += "')},T=function(e){k(e,!0)},S=function(e){var t=g(e),i=0!=y.length&&y[y.length-1].name;if(!i||t!=i)throw n(Error('Section named "'+t+'" was never opened'),r,R,a.file);var o=y.pop();p.push('";',"\n    return buffer;","\n  };","\n})();"),o.inverted?p.push("\nbuffer += renderSection(name,stack,callback,true);"):p.push("\nbuffer += renderSection(name,stack,callback);"),p.push('\nbuffer += "')},E=function(e){p.push('";',i,'\nbuffer += lookup("'+g(e)+'",stack,"");','\nbuffer += "')},B=function(e){p.push('";',i,'\nbuffer += escapeHTML(lookup("'+g(e)+'",stack,""));','\nbuffer += "')},R=1,I=0,A=r.length;A>I;++I)if(r.slice(I,I+f.length)===f){switch(I+=f.length,c=r.substr(I,1),i="\nline = "+R+";",o=f,s=d,v=!0,c){case"!":I++,l=null;break;case"=":I++,d="="+d,l=x;break;case">":I++,l=_;break;case"#":I++,l=k;break;case"^":I++,l=T;break;case"/":I++,l=S;break;case"{":d="}"+d;case"&":I++,b=!0,l=E;break;default:b=!0,l=B}var w=r.indexOf(d,I);if(-1===w)throw n(Error('Tag "'+f+'" was not closed properly'),r,R,a.file);var j=r.substring(I,w);l&&l(j);for(var U=0;~(U=j.indexOf("\n",U));)R++,U++;I=w+d.length-1,f=o,d=s}else switch(c=r.substr(I,1)){case'"':case"\\":b=!0,p.push("\\"+c);break;case"\r":break;case"\n":h.push(p.length),p.push("\\n"),m(),R++;break;default:t(c)?h.push(p.length):b=!0,p.push(c)}if(0!=y.length)throw n(Error('Section "'+y[y.length-1].name+'" was not closed properly'),r,R,a.file);m(),p.push('";',"\nreturn buffer;","\n} catch (e) { throw {error: e, line: line}; }");var D=p.join("").replace(/buffer \+= "";\n/g,"");return a.debug&&("undefined"!=typeof console&&console.log?console.log(D):"function"==typeof print&&print(D)),D}function s(e,t){var s="view,partials,stack,lookup,escapeHTML,renderSection,render",c=o(e,t),l=Function(s,c);return function(o,s){s=s||{};var c=[o];try{return l(o,s,c,a,r,i,u)}catch(f){throw n(f.error,e,f.line,t.file)}}}function c(){k={}}function l(e,t){return t=t||{},t.cache!==!1?(k[e]||(k[e]=s(e,t)),k[e]):s(e,t)}function u(e,t,r){return l(e)(t,r)}e.name="mustache.js",e.version="0.5.0-dev",e.tags=["{{","}}"],e.parse=o,e.compile=l,e.render=u,e.clearCache=c,e.to_html=function(e,t,r,n){var a=u(e,t,r);return"function"!=typeof n?a:(n(a),void 0)};var f,d=Object.prototype.toString,p=Array.isArray,h=Array.prototype.forEach,v=String.prototype.trim;f=p?p:function(e){return"[object Array]"===d.call(e)};var b;b=h?function(e,t,r){return h.call(e,t,r)}:function(e,t,r){for(var n=0,a=e.length;a>n;++n)t.call(r,e[n],n,e)};var g,m=/^\s*$/;if(v)g=function(e){return null==e?"":v.call(e)};else{var y,x;t("\u00a0")?(y=/^\s+/,x=/\s+$/):(y=/^[\s\xA0]+/,x=/[\s\xA0]+$/),g=function(e){return null==e?"":(e+"").replace(y,"").replace(x,"")}}var _={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},k={}}(e),e}),KISSY.add("brix/core/mu",function(e,t){function r(e,t){for(var r=n(e),i="",o=0;r.length>o;o++)i="if("+r[o]+")",t[i]||(t[i]=a(r[o]))}function n(e){var t=/\{{2,3}[\^#]?if\((.*?)\)\}{2,3}?/gi,r=/\{{2,3}[\^#]?if\((.*?)\)\}{2,3}?/i,n=e.match(t),a=[];if(n)for(var i=0;n.length>i;i++)a.push(n[i].match(r)[1]);return a}function a(e){e=e.split("==");var t=function(){for(var t=e[0].split("."),r=e[1],n=this,a=t.length-1;a>-1;a--){var i=t.slice(a),o=n;try{for(var s=0;i.length-1>s;s++)o=o[i[s]];if(i[i.length-1]in o)return""+o[i[i.length-1]]===r?!0:!1}catch(c){}}return!1};return t}function i(e,t){var r,n;for(r in e)n=e[r],n instanceof Array?o(n):"object"==typeof n&&5>t&&i(n,t+1)}function o(e){for(var t=0;e.length>t;t++){var r=e[t];"object"==typeof r&&(0===t?r.__first__=!0:t===e.length-1?r.__last__=!0:r.__mid__=!0,r.__index__=t)}}var s=/\s*<script[^>]+type\s*=\s*(['"])\s*text\/tmpl\1[^>]*>([\s\S]*?)<\/script>\s*/gi;return{to_html:function(e,n){"object"==typeof n&&i(n,0);var a=e.match(s);if(a&&(e=e.replace(s,function(){return'<script type="text/tmpl"></script>'})),e=e.replace(/(\{{2,3})@if/gi,"$1#if"),r(e,n),e=t.to_html.apply(this,arguments),a){var o=0;e=e.replace(s,function(){return a[o++]})}return e},name:t.name,version:t.version,tags:t.tags,parse:t.parse,compile:t.compile,render:function(){return this.to_html.apply(this,arguments)},clearCache:t.clearCache}},{requires:["./mustache"]}),KISSY.add("brix/core/tmpler",function(e,t,r,n){function a(e,t){this.tmpls=[],e&&t!==!1?this._bx_praseTmpl(e,t):this.tmpl=e}var i=r.all,o={};return e.augment(a,{_bx_praseTmpl:function(e,t){var r,a=this,s=!1;if("string"==typeof e)if("."===e.charAt(0)||"#"===e.charAt(0)||"body"===e)r=i(e);else{var c=/@TEMPLATE\|(.*?)\|TEMPLATE@/g;c.test(e)&&(e=e.replace(c,function(e,t){return o[t]||n({url:t,dataType:"html",async:!1,success:function(e){o[t]=e}}),o[t]||""}))}else r=e;if(r&&("SCRIPT"==r.item(0)[0].nodeName.toUpperCase()?e=r.item(0).html():s=!0),!s){for(var l="<([\\w]+)\\s+[^>]*?bx-tmpl=[\"']([^\"']+)[\"']\\s+[^>]*?bx-datakey=[\"']([^\"']+)[\"']\\s*[^>]*?>(@brix@)</\\1>";t--;)l=l.replace("@brix@","(?:<\\1[^>]*>@brix@</\\1>|[\\s\\S])*?");l=l.replace("@brix@","(?:[\\s\\S]*?)"),a.reg=l,a.tmpl=e,a._bx_buildTmpls(a.tmpl)}a.inDom=s},_bx_buildTmpls:function(e){for(var t,r=this,n=RegExp(r.reg,"ig");null!==(t=n.exec(e));)r.tmpls.push({name:t[2],datakey:t[3],tmpler:new a(t[4],!1)}),r._bx_buildTmpls(t[4])},addTmpl:function(e,t,r){var n=this;n.tmpls.push({name:e,datakey:t,tmpler:new a(r,!1)})},getTmpl:function(){return this.tmpl},render:function(e){return"function"==typeof t?new t(this.getTmpl()).render(e):t.render(this.getTmpl(),e)}}),a},{requires:[Brix.templateEngine,"node","ajax","sizzle"]}),KISSY.add("brix/core/dataset",function(e,t){function r(){r.superclass.constructor.apply(this,arguments)}return r.ATTRS={data:{}},e.extend(r,t,{setRenderer:function(e,t,r){var n,a,i=this,o=i.get("data");if(r=r?r+"_":"",e){var s=function(n,a){var i=r+n+"_"+a,s=e[n][a];o[i]=function(){return s.call(this,t,n)}};for(n in e)for(a in e[n])s(n,a)}}}),r},{requires:["base"]}),KISSY.add("brix/core/chunk",function(e,t,r,n,a,i){function o(e,t){for(var r=0;e.length>r;r++)for(var n=0;t.length>n;n++)if(e[r]==t[n])return!0;return!1}var s=t.all,c=e.noop,l=n.extend({constructor:function l(){var e=this;l.superclass.constructor.apply(e,arguments);var t=e.get("tmpler");(e.get("autoRender")||!t||t.inDom)&&e.render()},bindInternal:c,syncInternal:c,initializer:function(){var e=this,t=e.get("tmpl");if(t){e._bx_buildTmpler(t,e.get("level"));var r=e.get("tmpler");r&&(e._bx_buildDataset(e.get("data")),r.inDom&&e.set("el",t))}},_bx_buildTmpler:function(e,t){var r=this;if(!r.get("isBuidTmpler")){r.set("isBuidTmpler",!0);var n=new i(e,t);r.set("tmpler",n)}},_bx_buildDataset:function(t){var r=this;if(!r.get("isBuidDataset")){r.set("isBuidDataset",!0),t=e.clone(t||{});var n=new a({data:t});r.set("dataset",n),n.on("*Change",function(t){var a=!1,i=e.map(t.subAttrName,function(e){return/^data\./g.test(e)?(a=!0,e.replace(/^data\./,"")):"zuomo.xb@taobao.com"});a&&r._bx_renderTmpl(i,n.get("data"))})}},destructor:function(){var e=this,t=e.get("tmpler"),r=e.get("dataset");t&&(e.set("tmpler",null),delete t.tmpls),r&&(e.set("dataset",null),r.detach()),e.detach()},bindUI:c,syncUI:c,addTmpl:function(e,t,r){var n=this;if(n._bx_buildTmpler("",!1),n._bx_buildDataset(),e){var a=n.get("tmpler");a.addTmpl(e,t,r)}},setChunkData:function(t,r,n){var a=this,i=a.get("dataset");if(i){if(e.isObject(t)){t=e.clone(t);var o={};for(var s in t)o["data."+s]=t[s];t=o,n=r}else t="data."+t,r=e.clone(r);var c="html";n&&n.renderType&&(c=n.renderType,delete n.renderType),a.set("renderType",c),i.set.apply(i,arguments)}},render:function(){var e=this;if(!e.get("rendered")){e.fire("beforeRenderUI");var t=e.get("dataset");t&&e._bx_render(t.get("data")),e.fire("afterRenderUI"),e.setInternal("rendered",!0),e.fire("beforeBindUI"),l.superclass.bindInternal.call(e),e.callMethodByHierarchy("bindUI","__bindUI"),e.callMethodByHierarchy("initialize","constructor"),e.fire("afterBindUI"),e.fire("beforeSyncUI"),l.superclass.syncInternal.call(e),e.callMethodByHierarchy("syncUI","__syncUI"),e.fire("afterSyncUI")}return e},_bx_render:function(n){var a=this,i=a.get("tmpler");if(i&&!i.inDom){var o,c=a.get("container"),l=a.get("el"),u=e.trim(i.render(n));if(l&&0!==l.length)if(8>=r.ie){for(o=new t("<div />"),c.append(o),o.html(u);o[0].childNodes.length>0;)c[0].appendChild(o[0].childNodes[0]);o.remove(),o=null}else c.append(u);else{var f="brix_"+e.guid();if(8>=r.ie){o=new t("<div />"),c.append(o),o.html(u);var d=o[0].childNodes;if(d.length>1)o.attr("id",f);else{for(f=d[0].id||f,d[0].id=f;d.length>0;)c[0].appendChild(d[0]);o.remove(),o=null}}else o=new t(u),o.length>1?o=s('<div id="'+f+'"></div>').append(o):(f=o.attr("id")||f,o.attr("id",f)),c.append(o);a.set("el","#"+f)}}},_bx_renderTmpl:function(t,r){var n=this,a=n.get("tmpler");if(a&&n.get("rendered")){var i=n.get("el"),s=a.tmpls;e.each(s,function(a){var s=e.map(a.datakey.split(","),function(t){return e.trim(t)});if(o(s,t)){var c=i.all("[bx-tmpl="+a.name+"]");i.attr("bx-tmpl")==a.name&&(c=i.add(c)),c.each(function(t){if(t.attr("bx-datakey")==a.datakey){var i={};e.each(s,function(e){for(var t=r,n=e.split("."),a=n.length,o=0;o!==a;)t=t[n[o]],o++;i[n[a-1]]=t,t=null}),e.each(r,function(t,r){e.isFunction(t)&&(i[r]=t)});var o=n.get("renderType")||"html";n.fire("beforeRefreshTmpl",{node:t,renderType:o}),t[o](e.trim(a.tmpler.render(i))),n.fire("afterRefreshTmpl",{node:t}),i=null}}),c=null}})}}},{ATTRS:{el:{getter:function(t){return e.isString(t)&&(t=s(t)),t}},destroyAction:{value:"remove"},container:{value:"body",getter:function(t){return e.isString(t)&&(t=s(t)),t}},tmpl:{value:!1},tmpler:{value:!1},rendered:{value:!1},autoRender:{value:!0},data:{value:!1},dataset:{value:!1},level:{value:3}}});return l},{requires:["node","ua","rich-base","./dataset","./tmpler"]}),KISSY.add("brix/core/brick",function(e,t,r){var n=t.extend({initializer:function(){for(var e=this,t=e.constructor;t;){var r=t.RENDERERS;r&&(e.addTmpl(),e.get("dataset").setRenderer(r,e)),t=t.superclass&&t.superclass.constructor}e.pagelet=e.get("pagelet")},bindUI:function(){var e=this;e._bx_bindEvent()},_bx_detachEvent:function(){for(var e=this,t=e.constructor;t;){var r=t.EVENTS;r&&e._bx_removeEvents(r);var n=t.DOCEVENTS;n&&e._bx_removeEvents(n,document),t=t.superclass&&t.superclass.constructor}var a=e.get("events");a&&this._bx_removeEvents(a)},_bx_bindEvent:function(){for(var e=this,t=e.constructor;t;){var r=t.EVENTS;r&&this._bx_addEvents(r);var n=t.DOCEVENTS;n&&this._bx_addEvents(n,document),t=t.superclass&&t.superclass.constructor}var a=e.get("events");a&&this._bx_addEvents(a)},_bx_removeEvents:function(e,t){t=t||this.get("el");for(var n in e){var a=e[n];for(var i in a){var o=a[i];""===n?r.detach(t,i,o,this):r.undelegate(t,i,n,o,this)}}},_bx_addEvents:function(e,t){t=t||this.get("el");for(var n in e){var a=e[n];for(var i in a){var o=a[i];""===n?r.on(t,i,o,this):r.delegate(t,i,n,o,this)}}},destructor:function(){var e=this;if(e.get("rendered")){e._bx_detachEvent();var t=e.get("destroyAction"),r=e.get("el");switch(t){case"remove":r.remove();break;case"empty":r.empty()}}e.get("pagelet")&&(delete e.pagelet,e.set("pagelet",null))}},{ATTRS:{pagelet:{value:null}}},"Brick");return n},{requires:["./chunk","event"]}),KISSY.add("brix/core/pagelet",function(e,t){function r(t){if(!t.attr("id")){for(var r;(r=e.guid("brix_brick_"))&&e.one("#"+r););t.attr("id",r)}return t.attr("id")}var n=t.extend({initializer:function(){var e=this;e.isReady=!1,e.readyList=[],e.bricks=[],e.isAddBehavior=!1,e.destroyed=!1},bindUI:function(){var e=this,t=e.get("callback");t&&"function"==typeof t&&e.ready(t),e.get("autoBehavior")&&e.addBehavior()},getBrick:function(t){var r,n=this;return e.each(n.bricks,function(e){return e.id===t?(r=e.brick,!1):void 0}),r||null},destroyBrick:function(e){for(var t=this,r=0;t.bricks.length>r;r++){var n=t.bricks[r];if(e===n.id)return t._bx_destroyBrick(n),t.bricks.splice(r,1),!1}},_bx_destroyBrick:function(e){e.destroyed=!0,e.brick&&(e.brick.destroy&&e.brick.destroy(),e.brick=null)},addBehavior:function(){var e=this;if(e.get("rendered")&&!e.isAddBehavior){e.isAddBehavior=!0;var t=e.get("el"),r=t.all("[bx-name]");t.hasAttr("bx-name")&&(r=t.add(r)),e._bx_addBehavior(r,function(t){e.bricks=t},function(){e._bx_fireReady(),e.on("beforeRefreshTmpl",function(t){"html"===t.renderType&&t.node.all("[bx-name]").each(function(t){e.destroyBrick(t.attr("id"))})}),e.on("afterRefreshTmpl",function(t){e._bx_addBehavior(t.node.all("[bx-name]"),function(t){t.length>0&&(e.bricks=e.bricks.concat(t))},function(){e._bx_fireReady()})})})}},_bx_addBehavior:function(t,n,a){var i=this,o=i.get("config"),s=[];if(i.isReady=!1,t.each(function(t){if("true"!=t.attr("bx-behavior")){var n=r(t),a=t.attr("bx-name"),i=t.attr("bx-path"),c=Brix.returnJSON(t.attr("bx-config"));o&&o[n]&&e.mix(c,o[n]),t.attr("bx-behavior","true"),s.push({id:n,name:a,path:i,config:c})}}),s.length>0){var c=[];e.each(s,function(t){t.path||(t.path="brix/gallery/"+t.name+"/"),e.inArray(c,t.path)||t.config.autoBrick||c.push(t.path)}),i.fire("beforeAddBehavior",{useList:c}),n&&n(s),e.use(c.join(","),function(e){if(!i.destroyed){var t=arguments;e.each(s,function(r){if(!r.destroyed&&!r.config.autoBrick){var n=r.id,a=e.merge({container:"#"+n,el:"#"+n,pagelet:i},r.config),o=t[e.indexOf(r.path,c)+1],s=new o(a);r.brick=s}}),i.fire("afterAddBehavior",{useList:c,bricks:s}),c=null,t=null,a&&a()}})}else n&&n(s),a&&a()},ready:function(e){this.isReady?e.call(window,this):this.readyList.push(e)},_bx_fireReady:function(){var e=this;if(!e.isReady&&(e.isReady=!0,e.readyList)){for(var t,r=0;t=e.readyList[r++];)t.call(e);e.readyList=[]}},destructor:function(){var t=this;if(e.each(t.bricks,function(e){t._bx_destroyBrick(e)}),t.bricks=null,t.get("rendered")){var r=t.get("destroyAction"),n=t.get("el");switch(r){case"remove":n.remove();break;case"empty":n.empty()}n=null}t.destroyed=!0}},{ATTRS:{autoBehavior:{value:!0},callback:{value:null},config:{value:{}}}},"Pagelet");return n},{requires:["./chunk"]}),KISSY.add("brix/core/demolet",function(e,t,r,n){function a(e){return s[e]?!1:(s[e]=!0,r({url:e,dataType:"text",async:!1,complete:function(e,t){"success"==t&&o("<style>"+e+"</style>").appendTo("head")}}),void 0)}function i(t,n,a){a=a||"@",n=n||{};var i=RegExp("\\{\\{"+a+"(.+)?\\}\\}","ig");return t=t.replace(i,function(t,a){e.log(a);var i="",o=a.replace(/\//gi,"_").replace(/\./gi,"_");return n[o]=n[o]||{},r({url:a+"template.html",dataType:"html",async:!1,success:function(e){i="{{#"+o+"}}"+e+"{{/"+o+"}}"}}),r({url:a+"data.json",async:!1,dataType:"json",success:function(e){for(var t in e)n[o][t]=e[t]}}),i}),{tmpl:t,data:n}}var o=n.all,s={},c=t.extend({initializer:function(){var t=this;t.on("beforeAddBehavior",function(r){e.each(t.get("projectCSS"),function(e){a(e)});var n=r.useList;e.each(n,function(t){if(e.startsWith(t,"brix/"))e.use(t+"index.css");else{var r=3;e.startsWith(t,"imports/")&&(r=5);var n=t.split("/");n.length>r&&(n.splice(n.length-2),a(n.join("/")+"/index.css")),a(t.substring(0,t.lastIndexOf("/"))+"/index.css")}})})}},{ATTRS:{projectCSS:{value:[],setter:function(t){return e.isArray(t)?t:[t]}},s:{value:"@"},tmpl:{setter:function(e){var t=this,r=t.get("data")||{},n=i(e,r,t.get("s"));return t.set("data",n.data),n.tmpl}}}},"Demolet");return c},{requires:["./pagelet","ajax","node"]});