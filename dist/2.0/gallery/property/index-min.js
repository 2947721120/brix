KISSY.add("touchswip",function(){function t(t,e){var n={min_move_x:20,min_move_y:20,wipeLeft:function(){},wipeRight:function(){},wipeUp:function(){},wipeDown:function(){},preventDefaultEvents:!0};e&&(n=KISSY.merge(n,e)),t.each(function(){function t(){o.removeEventListener("touchmove",e),i=null,s=!1}function e(e){if(n.preventDefaultEvents&&e.preventDefault(),s){var r=e.touches[0].pageX,u=e.touches[0].pageY,l=i-r,c=a-u;Math.abs(l)>=n.min_move_x?(t(),l>0?n.wipeLeft(e,o):n.wipeRight(e,o)):Math.abs(c)>=n.min_move_y&&(t(),c>0?n.wipeDown(e,o):n.wipeUp(e,o))}}function r(t){1==t.touches.length&&(i=t.touches[0].pageX,a=t.touches[0].pageY,s=!0,o.addEventListener("touchmove",e,!1))}var i,a,o=this[0],s=!1;"ontouchstart"in document.documentElement&&o.addEventListener("touchstart",r,!1)})}return t},{requires:["event"]}),KISSY.add("brix/gallery/property/index",function(t,e,n,r,i){function a(){a.superclass.constructor.apply(this,arguments)}var o=t.DOM,s="";s+="<li class='pf-slide-item pf-slide-item-{{id}}' filterid='{{id}}' filtertype='pf-{{id}}' filtername='{{name}}'>",s+="    <div class='pf-content'>",s+="        <div class='filter-title'>{{name}}</div>",s+="        {{#hasImage}}",s+="        <div class='filter-items pf-image pf-fixed-height clear-fix'>",s+="            {{#imgitems}}",s+="            <a data-stat='{{stat}}' href='{{url}}' class='filter-item fp-item-{{id}} pf-image-item' filterid='{{id}}' filtername='{{name}}' title='{{name}}'>",s+="                <img src='{{image}}'>",s+="            </a>",s+="            {{/imgitems}}",s+="        </div>",s+="        {{/hasImage}}",s+="        {{#hasGroupNoImage}}",s+="        <div class='filter-items pf-fixed-height clear-fix pf-itemcotainer-{{id}}'>",s+="            {{#items}}",s+="                <a data-stat='{{stat}}' href='{{url}}' class='filter-item fp-item-{{id}}' filterid='{{id}}' filtername='{{name}}' title='{{name}}'>{{name}}</a>",s+="            {{/items}}",s+="        </div>",s+="        {{/hasGroupNoImage}}",s+="        {{#hasgroup}}",s+="        <div id='pf-band-cate' class='pf-band-more pf-switch'>",s+="            <ul class='ks-switchable-nav'>",s+="                {{#cate}}",s+="                <li>{{group_name}}<i class='iconfont'>&#404;</i></li>",s+="                {{/cate}}",s+="            </ul>",s+="           <div class='ks-switchable-content'>",s+="               {{#cate}}",s+="               <div style='display: none'>",s+="                   <div class='pf-switch-ul clear-fix pf-itemcotainer-{{id}}'>",s+="                       {{#items}}",s+="                           <a data-stat='{{stat}}' href='{{url}}' class='filter-item fp-item-{{id}}' filterid='{{id}}' filtername='{{name}}' title='{{name}}'>{{name}}</a>",s+="                       {{/items}}",s+="                   </div>",s+="               </div>",s+="               {{/cate}}",s+="            </div>",s+="        </div>",s+="        {{/hasgroup}}",s+="        {{^hasgroup}}",s+="        <div class='filter-items clear-fix pf-itemcotainer-{{id}}'>",s+="            {{#items}}",s+="                <a data-stat='{{stat}}' href='{{url}}' class='filter-item fp-item-{{id}}' filterid='{{id}}' filtername='{{name}}' title='{{name}}'>{{name}}</a>",s+="            {{/items}}",s+="        </div>",s+="        {{/hasgroup}}",s+="    </div>",s+=" </li>";var u="";u+="{{#items}}",u+="    <a data-stat='{{stat}}' href='{{url}}' class='filter-item newadded fp-item-{{id}}' filterid='{{id}}' filtername='{{name}}' title='{{name}}'>{{name}}</a>",u+="{{/items}}";var l="";return l+="    <div class='pf-st-slide'>",l+="        <div class='pf-st-wrap'>",l+="            {{#fp_cate}}",l+="            <span class='pf-st-item pf-{{id}}' filterid='{{id}}'>",l+="                {{#selectlist}}",l+="                <a href='{{url}}' class='selected-item pf-selid-{{id}}' filterid='{{id}}' filtername='{{name}}'>{{name}}<span class='del-btn'></span></a>",l+="                {{/selectlist}}",l+="            </span>",l+="            {{/fp_cate}}",l+="            {{#otherSelect}}",l+="            <span class='pf-st-item pf-other' filterid='other'>",l+="                <a href='{{url}}' class='selected-item pf-selid-{{type}} {{type}}-item' filterid='{{type}}' filtername='{{name}}'>{{name}}<span class='del-btn'></span></a>",l+="            </span>",l+="            {{/otherSelect}}",l+="            <a href='{{allurl}}' class='pf-st-clearall'><span>\u6e05\u9664\u5168\u90e8</span></a>",l+="        </div>",l+="    </div>",l+="    <a href='#' class='pf-st-indicator pf-st-prev'></a>",l+="    <a href='#' class='pf-st-indicator pf-st-next'></a>",a.ATTRS={mode:{value:1},templatePath:{cate:"components/property/template-cate.html",item:"components/property/template-item.html"},template:{cate:"",item:""},isCssAnim:!1,objMap:null,ajaxtimeout:null,data:{},curLink:"",containerWidth:0,minHeight:105,maxHeight:280,slideNum:0,slidePageNum:0,slidePerPage:0,slideDefaultWidth:280},a.METHODS={getTemplate:function(){a.ATTRS.template.cate=s,a.ATTRS.template.item=u,a.ATTRS.template.selected=l},updateUrl:function(e){var n=KISSY.clone(e.fp_cate);for(var r in n){var i=n[r];for(var a in i.items){var o=i.items[a],s=t.one(".fp-item-"+o.id);s&&s.length>0&&s.attr("href",o.url).attr("data-stat",o.stat)}for(var u in i.selectlist){var l=i.selectlist[u],s=t.one(".pf-selid-"+l.id);s&&s.length>0&&s.attr("href",l.url)}}},mergeData:function(e){function n(){var e={};for(var n in u){var r=t.one(".pf-slide-item-"+u[n].id);(null==r||0==r.length)&&(e[u[n].sort]=u[n],delete u[n])}return e}function r(){for(var e=o.getObjMap(),n=e.pfSlideItem,r=0;n.length>r;r++){var i=t.one(n[r]);void 0==u[i.attr("filterid")]&&(i.addClass("pf-deleteCate"),delete u[i.attr("filterid")])}return""}function i(){function e(e){var r=e.id;n[r]={items:[]};for(var i in e.items){var a=e.items[i],o=t.one("#J_propertyFilter .pf-itemcotainer-"+r+" .fp-item-"+a.id);null==o&&n[r].items.push(a)}}var n={};for(var r in u){var i=u[r];if(i.cate)for(var a in i.cate)e(i.cate[a]);i.items&&e(i)}return n}function a(){var e={};for(var n in u){var r=u[n];if(r.cate)for(var i in r.cate){var a=r.cate[i].items;for(var o in a){var s=a[o];e[s.id]=s}}if(r.imgitems)for(var l in r.imgitems){var s=r.imgitems[l];e[s.id]=s}if(r.items)for(var c in r.items){var s=r.items[c];e[s.id]=s}}for(var f=t.all(".filter-item"),h=0;f.length>h;h++){var d=t.one(f[h]);void 0==e[d.attr("filterid")]&&d.addClass("pf-deleteItem")}return""}var o=this,s=KISSY.clone(e.fp_cate),u={};for(var l in s)u[s[l].id]=s[l];var c={addCate:{fp_cate:n()},deleteCate:r(),additem:i(),deleteitem:a()};return c},getQueryParam:function(){return window.location.href},getPPath:function(){var e=t.all("#J_propertyFilter .filter-item.selected"),n={};e.each(function(){var e=t.one(t.DOM.parent(this,".pf-slide-item")).attr("filterid");3e4==e||(void 0==n[e]?n[e]=this.attr("filterid"):n[e]+=","+this.attr("filterid"))});var r="";for(var i in n)r+=i+":"+n[i]+";";return r.substring(0,r.length-1)},sendAjax:function(){return this.setAnchor(),void 0},setData:function(e){function i(e){if(e&&e.addCate&&e.addCate.fp_cate){var i=!0;t.one("#pf-band-cate")&&t.one("#pf-band-cate").length>0&&(i=!1);var s=e.addCate.fp_cate;for(var u in s){var l=r.to_html(a.ATTRS.template.cate,s[u]),c=t.one("#J_propertyFilter .pf-slide-item:eq("+(u-1)+")");if(c){var h=o.create(l);t.one(h).addClass("new-slide-item"),t.DOM.insertBefore(h,c[0])}else t.one(".pf-slide").append(l)}var d=t.all(".pf-slide-item");if(d.removeClass("new-slide-item"),f.animateFunc(d,{"margin-left":0},function(){}),f.calWidth(),i&&t.one("#pf-band-cate")&&t.one("#pf-band-cate").length>0){var p=n.Tabs;new p("#pf-band-cate",{triggerType:"click",switchTo:0})}}}function s(){f.animateFunc(t.all(".pf-deleteCate"),{opacity:0,"margin-left":-t.all(".pf-deleteCate").width()},function(t){t.remove(),f.calWidth()})}function u(e){for(var n in e.additem)if(0!=e.additem[n].items.length){var i=r.to_html(a.ATTRS.template.item,e.additem[n]);t.one(".pf-itemcotainer-"+n).append(i)}var o=t.all(".filter-item.newadded").length;f.animateFunc(t.all(".filter-item.newadded"),{"margin-left":20},function(e){if(e.removeClass("newadded"),0==--o){var n=t.one(".pf-slide-item.norelative");n&&n[0]&&f.showMore(n[0])}})}function l(){f.animateFunc(t.all(".pf-deleteItem:not(.pf-image-item)"),{opacity:0,"margin-left":-50},function(e){e.remove();var n=t.one(".pf-slide-item.norelative");n&&n[0]&&f.showMore(n[0])})}function c(){var e=r.to_html(a.ATTRS.template.selected,h);t.one(".pf-selected").html(e);var n=f.getObjMap(!0);t.one(".pf-st-slide").css("width",n.pfPanel.width()-100),f.checkSelectedStatus(!0)}var f=this,h=KISSY.JSON.parse(e);if(0!=h.fp_cate.length){this.updateUrl(h);var d=this.mergeData(h);i(d),s(),u(d),l(),c()}},setAnchor:function(){return},getPfHeight:function(){var t=a.ATTRS.minHeight,e=this.getObjMap();return"none"!=e.pfSelected.css("display")&&(t+=e.pfSelected.outerHeight()+parseInt(e.pfSelected.css("padding-top"))),t},getObjMap:function(e){return(null==a.ATTRS.objMap||e)&&(a.ATTRS.objMap={pfObj:t.one("#J_propertyFilter"),pfSlideItem:t.all(".pf-slide-item"),pfSelectedItem:t.all(".selected-item"),pfReplaceObj:t.one(".pf-replace"),pfWrapObj:t.one("#J_propertyFilter .contentwrap"),flushingSlide:t.one("#J_propertyFilter .flushingSlide"),pfPanelWrap:t.one("#J_propertyFilter .pf-panel-wrap"),pfPanel:t.one("#J_propertyFilter .pf-panel"),pfSelected:t.one("#J_propertyFilter .pf-selected"),pfclearAll:t.one("#J_propertyFilter .pf-st-clearall"),pfPagination:t.one("#J_propertyFilter .pf-pagination"),pfShadow:t.one("#J_propertyFilter .pf-shadow"),indicator:t.all("#J_propertyFilter .pagi-indicator")}),a.ATTRS.objMap},bindFixedEvent:function(){function e(){return t.one("#J_propertyFilter").hasClass("property-fixed")?!0:!1}var n=this;t.Event.delegate("#J_propertyFilter","mouseenter",".pf-selected",function(){e()&&!t.one("#J_propertyFilter").hasClass("hover")&&n.fixedMouseEnter()}),t.Event.delegate("#J_propertyFilter","mouseenter",".flushingSlide",function(){e()&&n.fixedMouseEnter()}),t.Event.on("#J_propertyFilter","mouseleave",function(){e()&&n.fixedMouseLeave()})},fixedShow:function(){function e(){var e=i.pfObj.offset().left;i.pfReplaceObj.height(parseInt(i.pfObj.height())+parseInt(i.pfObj.css("margin-bottom"))).show(),i.pfObj.css({width:t.one(".wrap").width()-e+t.one(".wrap").offset().left}),i.pfObj.addClass("property-fixed"),t.UA.ie&&6==t.UA.ie&&i.pfObj.css("top",t.one(window).scrollTop()),a.ATTRS.isCssAnim&&i.pfWrapObj.css("overflow","hidden"),r.animateFunc(i.pfWrapObj,{height:24},function(){n()})}function n(){i.pfPanel.hide(),i.indicator.addClass("hide");var e=i.pfSelectedItem;e.length>0?(i.pfPagination.show(),i.pfSelected.addClass("show"),i.flushingSlide.hide()):(i.pfPagination.hide(),i.pfSelected.removeClass("show"),i.flushingSlide.show()),i.pfObj.removeClass("hover"),i.pfShadow.show();var n=t.all("#J_propertyFilter .pf-flush-item");r.animateFunc(n,{width:n.attr("oriwidth")},function(){},.05)}var r=this,i=this.getObjMap();e()},fixedHide:function(){function e(){r.pfReplaceObj.hide(),r.pfObj.removeClass("property-fixed"),r.pfObj.css({left:"auto",width:"auto"}),t.UA.ie&&6==t.UA.ie&&(r.pfObj.css("top",0),r.pfObj[0].offsetLeft),0==r.pfSelectedItem.length&&r.pfSelected.removeClass("show"),n.animateFunc(r.pfWrapObj,{height:n.getPfHeight()},function(){r.pfPanel.show(),r.indicator.removeClass("hide"),r.flushingSlide.hide()})}var n=this,r=this.getObjMap();r.pfObj.stop(!0),r.pfWrapObj.stop(!0),r.pfObj.hasClass("property-fixed")&&e()},fixedMouseEnter:function(){var e=this,n=this.getObjMap(),r=t.all("#J_propertyFilter .pf-flush-item");this.animateFunc(r,{width:parseInt(r.attr("oriwidth"))+100},function(){n.pfObj.addClass("hover"),n.flushingSlide.hide(),n.indicator.removeClass("hide"),n.pfShadow.hide(),n.pfPanel.show(),"block"==n.pfSelected.css("display")&&n.pfPagination.show(),e.animateFunc(n.pfWrapObj,{height:e.getPfHeight()},function(){n.pfWrapObj.css("overflow","visible")})},.05)},fixedMouseLeave:function(){this.fixedShow()},selfAnimateHeight:function(e,n,r,i){var o=!1;a.ATTRS.isCssAnim&&e[0]&&e[0].style&&"webkitTransition"in e[0].style&&(o=!0);var s=!1,u=this;if(t.UA.ie&&6==t.UA.ie)e.height(n),i(e);else if(o)t.Event.detach(e,"webkitTransitionEnd"),t.Event.on(e,"webkitTransitionEnd",function(){return i(e),t.Event.detach(e,"webkitTransitionEnd"),!1}),e.height(n);else if(s){var l,c=20,f=n-e.height(),h=f/r;l=setInterval(function(){var t=e.height()+h*c;f>0&&n>t?e.height(t):0>f&&t>n?e.height(t):(e.height(n),clearInterval(l),i(e))},c)}else u.animateFunc(e,{height:n},function(){i(e)},r/1e3)},checkSelectedStatus:function(t){var e=this,n=e.getObjMap(!0);if(n.pfSelectedItem.length>0?("none"==n.pfSelected.css("display")?(n.pfSelected.addClass("show"),n.pfclearAll.addClass("show"),n.pfPagination.show(),e.selfAnimateHeight(n.pfSelected,34,200,function(){}),e.selfAnimateHeight(n.pfWrapObj,a.ATTRS.minHeight+34,200,function(){})):(n.pfclearAll.addClass("show"),n.pfPagination.show()),e.setSelIndicatorSt()):(n.pfclearAll.removeClass("show"),n.pfPagination.hide(),e.selfAnimateHeight(n.pfWrapObj,a.ATTRS.minHeight,200,function(){n.pfSelected.removeClass("show")}),e.selfAnimateHeight(n.pfSelected,0,200,function(){n.pfSelected.removeClass("show")})),!t){var r=!1;r?(clearTimeout(a.ATTRS.ajaxtimeout),a.ATTRS.ajaxtimeout=setTimeout(function(){e.sendAjax()},300)):e.sendAjax()}},setSelectedStyle:function(){var e=t.all("#J_propertyFilter .selected-item");if(e.length>0)for(var n=0;e.length>n;n++){var r=t.one(e[n]).attr("filterid");t.all("#J_propertyFilter .fp-item-"+r).addClass("selected")}},setSelIndicatorSt:function(){var e=t.one(".pf-st-slide"),n=t.one(".pf-st-clearall"),r=e.offset().left+e.width(),i=e.scrollLeft(),a=n.width()+n.offset().left;a>r?t.one(".pf-st-next").show():t.one(".pf-st-next").hide(),i>0?t.one(".pf-st-prev").show():t.one(".pf-st-prev").hide()},getCurSelWidth:function(){var t=this,e=t.getObjMap(),n=e.pfSelectedItem,r=0;return n.each(function(){r+=this[0].offsetWidth+10}),r+150},initSelected:function(){function e(e,n,i,a){r.getObjMap();var s=o.children(".pf-st-wrap","."+e);t.all(".fp-item-"+n).addClass("selected");var u='<a href="#" style="margin-left:-50px;" class="selected-item pf-selid-'+n+'" filterid="'+n+'" filtername="'+i+'" title="'+i+'">'+i+'<span class="del-btn"></span></a>';"pf-30000"==e&&(u='<a href="#" link="'+a.attr("href")+'" style="margin-left:-50px;" class="selected-item priceRange-item pf-selid-'+n+'" filterid="'+n+'" filtername="'+i+'" title="'+i+'">'+i+'<span class="del-btn"></span></a>'),t.one(".pf-st-wrap").width(r.getCurSelWidth()+30*i.length),t.one(s).prepend(u),r.getObjMap(!0),r.checkSelectedStatus(!0),r.animateFunc(t.one(".pf-selid-"+n),{"margin-left":0},function(e){e.css({opacity:1}),r.checkSelectedStatus(),t.one(".pf-st-wrap").width(r.getCurSelWidth())})}function n(e){t.all(".fp-item-"+e).removeClass("selected");var n=t.one(".pf-selid-"+e);n.css("z-index",0),r.animateFunc(n,{"margin-left":-(n.width()+35)},function(e){e.remove(),r.getObjMap(!0),t.one(".pf-st-wrap").width(r.getCurSelWidth()),r.checkSelectedStatus()},.3)}var r=this,i=r.getObjMap();t.Event.delegate("#J_propertyFilter","click",".filter-item",function(i){var s=t.one(i.target),u=o.parent(i.target,".pf-slide-item");s.hasClass("filter-item")||(s=s.parent(".filter-item")),a.ATTRS.curLink=s.attr("href");var l=t.one(u).attr("filtertype"),c=t.one(u).attr("filterid"),f=s.attr("filterid"),h=s.attr("filtername");return s.hasClass("selected")?n(f):(e(l,f,h,s),"30000"==c&&r.animateFunc(t.one(".pf-slide-item-30000"),{opacity:0,"margin-left":-t.all(".pf-slide-item-30000").width()},function(t){t.remove(),r.calWidth()},.3)),!1}),t.Event.delegate("#J_propertyFilter","click",".selected-item",function(e){a.ATTRS.curLink=e.target.href;var r=t.one(e.target);r.hasClass("selected-item")||(r=t.one(o.parent(e.target,".selected-item")));var i=r.attr("filterid");return n(i),!1}),t.Event.delegate("#J_propertyFilter","mouseenter",".selected-item",function(e){i.pfSelectedItem.removeClass("hover"),t.one(e.target).addClass("hover")}),t.Event.delegate("#J_propertyFilter","mouseleave",".selected-item",function(e){t.one(e.target).removeClass("hover")}),t.Event.delegate("#J_propertyFilter","click",".pf-st-clearall",function(e){var n=t.one(e.target);return n.hasClass("pf-st-clearall")||(n=n.parent(".pf-st-clearall")),a.ATTRS.curLink=n.attr("href"),t.all(".filter-item").removeClass("selected"),r.animateFunc(t.all(".selected-item"),{"margin-left":-70},function(t){t.remove(),r.checkSelectedStatus()},.3),!1}),t.Event.delegate("#J_propertyFilter","click",".pf-st-prev",function(){var e=t.one(".pf-st-slide"),n=e.width();return t.one(".pf-st-wrap").width(r.getCurSelWidth()),r.animateFunc(e,{scrollLeft:e.scrollLeft()-n},function(){r.setSelIndicatorSt()},.6),!1}),t.Event.delegate("#J_propertyFilter","click",".pf-st-next",function(){var e=t.one(".pf-st-slide"),n=e.width();return t.one(".pf-st-wrap").width(r.getCurSelWidth()),r.animateFunc(e,{scrollLeft:e.scrollLeft()+n},function(){r.setSelIndicatorSt()},.6),!1}),r.setSelectedStyle(),r.checkSelectedStatus(!0)},removeDuplicate:function(){var e=t.all("#J_propertyFilter .pf-fixed-height:not(.pf-image) .filter-item");if(e)for(var n=0;e.length>n;n++)if(!(e[n].offsetTop>100)){var r=t.one(e[n]).attr("filterid"),i=t.one("#pf-band-cate .fp-item-"+r);i&&i.addClass("hidden")}},initSlide:function(){if("webkitTransition"in t.DOM.get("#J_propertyFilter").style&&(a.ATTRS.isCssAnim=!0),a.ATTRS.isCssAnim?t.one("#J_propertyFilter").addClass("useCssAnimate"):t.one("#J_propertyFilter").removeClass("useCssAnimate"),t.one("#pf-band-cate")&&t.one("#pf-band-cate").length>0){var e=n.Tabs;new e("#pf-band-cate",{triggerType:"click",switchTo:0})}var r=this;this.calWidth();var i=null;t.Event.on(window,"scroll",function(){clearTimeout(i),i=setTimeout(function(){var e=t.one(".main").offset().top,n=t.one(window).scrollTop();if(n>e){var i=r.getObjMap();if(t.UA.ie&&6==t.UA.ie);else if(i.pfObj.hasClass("property-fixed"))return;var a=t.DOM.get(".pf-slide-item.norelative");a&&r.hideMore(a),r.fixedShow()}else{var i=r.getObjMap();i.pfObj.hasClass("property-fixed")&&r.fixedHide()}},50)}),r.bindFixedEvent(),t.Event.delegate("#J_propertyFilter","click",".pf-pg-link",function(e){t.one(e.target).addClass("active").siblings().removeClass("active");var n=r.getObjMap(),i=n.pfPanel,o=n.pfSlideItem.width()*a.ATTRS.slidePerPage,s=o-(i.width()-o)/2;return r.animateFunc(i,{scrollLeft:s+o*(parseInt(t.one(e.target).attr("num"))-1)},function(){}),0==t.one(e.target).attr("num")?(t.one(".pagi-prev").removeClass("show"),t.one(".pagi-next").addClass("show")):t.one(e.target).attr("num")==a.ATTRS.slidePageNum-1?(t.one(".pagi-prev").addClass("show"),t.one(".pagi-next").removeClass("show")):(t.one(".pagi-prev").addClass("show"),t.one(".pagi-next").addClass("show")),!1}),t.Event.delegate("#J_propertyFilter","click",".pagi-prev",function(){var e=t.one(".pf-pg-link.active");e.prev()&&e.prev().fire("click")}),t.Event.delegate("#J_propertyFilter","click",".pagi-next",function(){var e=t.one(".pf-pg-link.active");e.next()&&e.next().fire("click")}),t.Event.on(".pf-content","click",function(){return}),t.Event.delegate("#J_propertyFilter","mouseenter",".pf-content",function(e){var n=o.parent(e.target,".pf-slide-item"),i=o.parent(e.target,".pf-panel");if(!t.one(n).hasClass("no-slidedown")){var a=n.offsetLeft,s=n.offsetLeft+n.offsetWidth,u=i.scrollLeft,l=i.scrollLeft+i.offsetWidth;a>=u&&l>=s&&r.showMore(n)}}),t.Event.delegate("#J_propertyFilter","mouseleave",".pf-content",function(t){r.hideMore(o.parent(t.target,".pf-slide-item"))}),t.Event.delegate("#J_propertyFilter","mouseenter",".ks-switchable-nav li",function(e){t.one(e.target).fire("click")}),r.removeDuplicate()},getpfContentHeight:function(t,e){var n=t.children(".filter-title").height(),r=0;t.children(".filter-items").each(function(){r+=this.height()});var i=n+r+e;return a.ATTRS.minHeight>=i?a.ATTRS.minHeight:i>=a.ATTRS.maxHeight?a.ATTRS.maxHeight:i},animateFunc:function(e,n,r,i){var o=!1;a.ATTRS.isCssAnim&&void 0==n.width&&void 0==n.scrollLeft&&(o=!0),t.UA.ie&&6==t.UA.ie?(n.scrollLeft&&(e.scrollLeft(n.scrollLeft),delete n.scrollLeft),e.css(n),r(e)):o?(t.Event.detach(e,"webkitTransitionEnd"),t.Event.on(e,"webkitTransitionEnd",function(){return t.Event.detach(e,"webkitTransitionEnd"),r(e),!1}),e.css(n)):(e.hasClass("property-fixed")?e.stop(!0):e.stop(!1),e.animate(n,{duration:i||.5,easing:"easeOutStrong",complete:function(){r(e)}}))},showMore:function(e){var n=this.getObjMap(),r=t.one(".pf-slide"),i=t.one(o.children(e,".pf-content")),s=i.children(".filter-items:not(.pf-fixed-height)"),u=i.children(".filter-items.pf-fixed-height"),l=s.height(),c=i.children(".pf-switch");s.removeClass("maxheight");var f=14,h=c&&c.length>0,d=u&&u.length>0;if(h&&d)f=300;else if(!h&&d)150>=l?s.css({height:"auto"}):(f=300,s.css({overflow:"auto",height:"158"}));else{if(80>=l)return;l>244&&s.addClass("maxheight")}n.pfWrapObj.css("overflow","visible"),i.css({width:t.one(e).width()-1,overflow:"hidden",left:parseInt(e.offsetLeft)}),t.one(e).addClass("norelative");var p=this.getpfContentHeight(i,f);n.pfPanelWrap.css("border-bottom","none"),this.animateFunc(r,{height:p+5},function(){}),a.ATTRS.isCssAnim?i.height(p-3):this.animateFunc(i,{height:p-3},function(){})},hideMore:function(e){if(t.one(e).hasClass("norelative")){var n=t.one(".pf-slide"),r=t.one(o.children(e,".pf-content")),i=r.children(".filter-items");i.removeClass("maxheight"),r.scrollTop(0),this.animateFunc(r,{height:a.ATTRS.minHeight},function(){r.css({width:"100%",overflow:"hidden",height:a.ATTRS.minHeight,left:0}),t.one(e).removeClass("norelative")}),this.animateFunc(n,{height:a.ATTRS.minHeight},function(){})}},calWidth:function(){var e=this.getObjMap(!0),n=e.pfPanel,r=e.pfSlideItem,i=t.one(".pf-slide"),s=t.one(".pf-st-slide");s.css("width",n.width()-100);var u=Math.floor(n.width()/a.ATTRS.slideDefaultWidth);u=r.length>u?u:r.length;var l=Math.ceil(r.length/u);if(n.width()!=a.ATTRS.containerWidth||r.length!=a.ATTRS.slideNum){if(a.ATTRS.slideNum=r.length,a.ATTRS.containerWidth=n.width(),1==l){i.width(n.width());var c=parseInt(n.width()/u);r.width(c),r.children(".pf-content").width(c),t.one("#pf-band-cate")&&t.one("#pf-band-cate").length>0&&this.hideMore(o.parent("#pf-band-cate",".pf-slide-item")),c>450&&t.one("#pf-band-cate")&&t.one("#pf-band-cate").parent(".pf-slide-item")&&t.one("#pf-band-cate").parent(".pf-slide-item").addClass("no-slidedown")}else i.width(r.length*a.ATTRS.slideDefaultWidth),r.width(a.ATTRS.slideDefaultWidth),r.removeClass("no-slidedown");a.ATTRS.slidePageNum=l,a.ATTRS.slidePerPage=u,this.animateFunc(n,{scrollLeft:0},function(){},1),this.generatePagition(l)}this.generateFlushItem()},generateFlushItem:function(){var e=this.getObjMap(),n="";e.pfSlideItem.each(function(e,r){if(5>r){var i=t.one(this).attr("filterid"),a=t.one(this).attr("filtername");n+='<span class="pf-flush-item pf-flush-item-'+i+'" filterid="'+i+'" filtertype="pf-'+i+'">'+a+"</span>"}}),e.flushingSlide.html(n);var r=t.all(".pf-flush-item"),i=parseInt((e.pfPanel.width()-30)/r.length);r.width(i),r.attr("oriwidth",i)},generatePagition:function(e){var n=this.getObjMap();if(n.indicator.removeClass("show"),1>=e)n.pfPagination.html("");else{t.one(".pagi-next").addClass("show");for(var r="",i=0;e>i;i++)r+='<a href="#" class="pf-pg-link '+(0==i?"active":"")+'" num="'+i+'">'+i+"</a>";n.pfPagination.html(r)}},registerTouchEvent:function(){if(!t.UA.ie||6!=t.UA.ie){var e=this.getObjMap();i(e.pfPanel,{wipeLeft:function(){KISSY.one("#J_propertyFilter .pagi-next").fire("click")},wipeRight:function(){KISSY.one("#J_propertyFilter .pagi-prev").fire("click")},wipeUp:function(){},wipeDown:function(){},min_move_x:20,min_move_y:20,preventDefaultEvents:!0})}}},a.EVENTS={"#J_unfold":{click:function(){}}},t.extend(a,e,{initialize:function(){this.initSlide(),this.initSelected(),this.registerTouchEvent(),this.getTemplate()},setAjaxData:function(t){this.setData(t)}}),t.augment(a,a.METHODS),a},{requires:["brix/core/brick","switchable","brix/core/mustache","touchswip","../property/index.css"]});