KISSY.add("brix/core/pagelet",function(a,b){function c(){c.superclass.constructor.apply(this,arguments);var a=this;a.isReady=!1,a.readyList=[],a.brickList=[],a.isAddBehavior=!1,(a.get("autoRender")||a.get("tmpler").inDom)&&a.ready(function(){a.render()});var b=a.get("callback");b&&typeof b=="function"&&a.ready(b),a.get("behavior")&&a.addBehavior()}return c.ATTRS={behavior:{value:!0},callback:{value:null}},a.extend(c,b,{getBrick:function(b,c){var d=this,e=d.get("tmpler"),f;return e&&a.each(e.bricks,function(a){if(a.id===b)return f=a.brick,!1}),f||null},addBehavior:function(){var b=this;if(!b.isAddBehavior){b.isAddBehavior=!0;var c=b.get("tmpler");if(c){var d=c.bricks;b._buildBricks(d);if(b.brickList.length>0){a.use(b.brickList.join(","),function(a){b._addBehavior(d,arguments),b._fireReady()});return}}b._fireReady()}},_addBehavior:function(b,c){var d=this;a.each(b,function(b){var e=b.id,f=a.merge({container:"#"+e,id:e,el:"#"+e,pagelet:d},b.config),g=c[a.indexOf(b.path,d.brickList)+1],h=new g(f);b.brick=h})},_buildBricks:function(b){var c=this;a.each(b,function(b){b.path||(b.path="brix/gallery/"+b.name+"/"),a.inArray(c.brickList,b.path)||c.brickList.push(b.path)})},ready:function(a){this.isReady?a.call(window,this):this.readyList.push(a)},_fireReady:function(){var a=this;if(a.isReady)return;a.isReady=!0;if(a.readyList){var b,c=0;while(b=a.readyList[c++])b.call(a);a.readyList=null}},destroy:function(a){var b=this,c=b.get("el"),d=b.get("tmpler");d&&b._destroyBricks(d.bricks,a),a||(d.tmpls=null,d.bricks=null,c.remove()),c=null},_destroyBricks:function(b,c){var d=this;a.each(b,function(a,b){if(c){if(c===a.id)return d._destroyBrick(a),!1}else d._destroyBrick(a)})},_destroyBrick:function(a){var b=this;a.brick&&(a.brick.destroy(),a.brick=null)}}),c},{requires:["./chunk"]});