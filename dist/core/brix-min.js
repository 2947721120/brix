(function(a,b){function g(b){b=a.trim(b),b&&b.charAt(b.length-1)!="/"&&(b+="/"),!b.match(/^(http(s)?)|(file):/i)&&!e(b,"/")&&(b=f+b);if(e(b,"/")){var d=c.location;b=d.protocol+"//"+d.host+b}var g=b.split("/"),h=[],i;for(var j=0;j<g.length;j++)i=g[j],i!="."&&(i==".."?h.pop():h.push(i));return b=h.join("/"),b.substring(0,b.length-1)}function h(){var b=/^(.*)brix(-min)?\.js[^/]*/i,d=/brix(-min)?\.js/i,e=c.document.getElementsByTagName("script"),f=e[e.length-1],h=g(f.src),i=f.getAttribute("bx-config");i?i=(new Function("return "+i))():i={},i.comboPrefix=i.comboPrefix||"??",i.comboSep=i.comboSep||",";var j=i.comboPrefix,k=i.comboSep,l=h.split(k),m,n=l[0],o,p=n.indexOf(j);return p==-1?m=h.replace(b,"$1"):(m=n.substring(0,p),o=n.substring(p+2,n.length),o.match(d)?m+=o.replace(b,"$1"):a.each(l,function(a){if(a.match(d))return m+=a.replace(b,"$1"),!1})),m=m.substring(0,m.lastIndexOf("brix")),a.mix({path:m,componentsPath:"./",importsPath:"./"},i)}var c=window,d=c.location,e=a.startsWith,f=d.href.replace(d.hash,"").replace(/[^/]*$/i,"");b=c[b]=c[b]||{};var i=h(),j="",k=!1;a.mix(b,{config:function(a){if(k)return;k=!0,a=KISSY.merge({fixed:"",gallery:{}},i,a),KISSY.config({packages:[{name:"brix",path:a.path,charset:"utf-8"},{name:"components",path:a.componentsPath,charset:"utf-8"},{name:"imports",path:a.importsPath,charset:"utf-8"}]}),KISSY.config({map:[[/(.+brix\/)(gallery\/)(.+?)(\/.+?(?:-min)?\.(?:js|css))(\?[^?]+)?$/,function(b,c,d,e,f,g){var h=c+a.fixed+d+e;return a.gallery[e]&&(h+="/"+a.gallery[e]),j&&(f=f.replace("-min","")),h+=f+(g?g:""),h}],[/(.+brix\/)(core.+?)((?:-min)?\.js)(\?[^?]+)?$/,function(b,c,d,e,f){var g=c+a.fixed;return j&&(e=e.replace("-min","")),g+=d+e+(f?f:""),g}]]})}}),i.autoConfig&&b.config({})})(KISSY,"Brix");