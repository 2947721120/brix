KISSY.add("brix/core/brick",function(a,b){function c(b,c){return a.isString(c)?b[c]:c}function d(){var a=this;a.pagelet=arguments[0]?arguments[0].pagelet:null,d.superclass.constructor.apply(this,arguments);var b=a.get("id"),c=a.get("tmpler"),e=a.constructor.RENDERER;if(e){var f=a.pagelet?a.pagelet:a;f.get("dataset").setRenderer(e,a,b)}a.on("rendered",function(){a.initialize(),a._bindEvent()}),a.pagelet?a.pagelet.get("rendered")?a.render():a.pagelet.on("rendered",function(){a.render()}):(a.get("autoRender")||!c||c.inDom)&&a.render()}return d.ATTACH={},d.ATTRS={events:{}},a.extend(d,b,{initialize:function(){},destructor:function(){},_detachEvent:function(){var b=this,c=b.constructor.ATTACH;c&&b._removeEvents(c);var d=b.constructor.DOCATTACH;d&&b._removeEvents(d,a.one(document)),b._undelegateEvents();var e=b.get("events");e&&this._removeEvents(e),b.destructor()},_bindEvent:function(){var b=this,c=b.constructor.ATTACH;c&&this._addEvents(c);var d=b.constructor.DOCATTACH;d&&this._addEvents(d,a.one(document)),b._delegateEvents();var e=b.get("events");e&&this._addEvents(e)},events:{},_removeEvents:function(a,b){b=b||this.get("el");for(var d in a){var e=a[d];for(var f in e){var g=c(this,e[f]);d===""?b.detach(f,g,this):b.undelegate(f,d,g,this)}}},_addEvents:function(a,b){b=b||this.get("el");for(var d in a){var e=a[d];for(var f in e){var g=c(this,e[f]);d===""?b.on(f,g,this):b.delegate(f,d,g,this)}}},_delegateEvents:function(){var a=this.events,b=this.get("el")[0],c=this;for(var d in a)(function(){var a=d;b["on"+a]=function(){var b=arguments[0]||window.event,d=b.target||b.srcElement;d.nodeType!==1&&(d=d.parentNode);var e=d.getAttribute("bx"+a);if(e){var f=e.split("|"),g,h;for(var i=0;i<f.length;i++){g=f[i].split(":"),h=g.shift();var j=g[g.length-1],k=!1;if(j==="_halt_"||j==="_preventDefault_")b.preventDefault?b.preventDefault():b.returnValue=!1,k=!0;if(j==="_halt_"||j==="_stop_")b.stopPropagation?b.stopPropagation():b.cancelBubble=!0,k=!0;k&&g.pop(),c.events&&c.events[a]&&c.events[a][h]&&c.events[a][h].call(c,d,g)}}d=null}})()},_undelegateEvents:function(){var a=this.events,b=this.get("el")[0],c=this;for(var d in a)(function(){var a=d;b["on"+a]=null})()},destroy:function(){var b=this,c=b.get("tmpler");c&&!a.isEmptyObject(c.bricks)&&a.each(c.bricks,function(a,b){c.bricks[b].brick=null,delete c.bricks[b]});if(b.pagelet){var d=b.get("id");b.pagelet.destroy(d)}else b._detachEvent(),b.get("el").remove()}}),d},{requires:["./chunk"]});