KISSY.add("brix/gallery/kwicks/index",function(e,t){function n(){n.superclass.constructor.apply(this,arguments)}return n.ATTRS={isVertical:{value:!1},sticky:{value:!1},activeIndex:{value:0},triggerType:{value:"mouseenter"},activeCls:{value:"active"},spacing:{value:0},duration:{value:.3},easing:{value:"easeNone"},max:{},min:{},autoplay:{value:!1},interval:{value:3e3}},n.ATTACH={"":{mouseenter:function(){var e=this,t=e.get("autoplay");t&&e.stop()},mouseleave:function(){var e=this,t=e.get("autoplay"),n=e.get("sticky");if(t)e.start();else if(!n){var r=e.kwicks,i=r.length,s=e.get("activeCls"),o=e.get("spacing"),u=e.get("duration"),a=e.get("easing"),f=e.LoT,l=e.WoH,c=e.normWoH;r.stop().removeClass(s),r.each(function(e,t){var n={};n[l]=c,t<i-1&&(n[f]=t*c+t*o),e.animate(n,u,a)})}}}},n.METHOD={switchTo:function(e){var t=this,n=t.kwicks,r=n.length,i=t.preCalcLoTs,s=t.get("activeCls"),o=t.get("duration"),u=t.get("easing"),a=t.LoT,f=t.WoH,l=t.max,c=t.min;e>=r||e<0?(e=0,t.set("activeIndex",0)):t.set("activeIndex",e);var h=n.item(e);n.stop().removeClass(s),h.addClass(s),n.each(function(t,n){var s={};h[0]==t[0]?(s[f]=l,n>0&&n<r-1&&(s[a]=i[e][n])):(s[f]=c,n>0&&n<r-1&&(s[a]=i[e][n])),t.animate(s,o,u)})},start:function(){var t=this,n=t.get("autoplay"),r=t.get("interval");n&&(t.stop(),t.timer=e.later(function(){var e=t.get("activeIndex");t.switchTo(e+1)},r,!0,t))},stop:function(){var e=this;e.timer&&(e.timer.cancel(),e.timer=null)}},e.extend(n,t,{initialize:function(){var e=this,t=e.get("isVertical"),n=e.get("sticky"),r=e.get("activeIndex"),s=e.get("triggerType"),o=e.get("activeCls"),u=e.get("spacing"),a=e.get("duration"),f=e.get("easing"),l=e.max=e.get("max"),c=e.min=e.get("min"),h=e.get("autoplay"),p=e.WoH=t?"height":"width",d=e.LoT=t?"top":"left",v=e.get("el"),m=e.kwicks=v.all("li"),g=m.length,y=e.normWoH=m.item(0).css(p).replace(/px/,"");l?c=e.min=(y*g-l)/(g-1):l=e.max=y*g-c*(g-1),t?v.css({width:m.item(0).css("width"),height:y*g+u*(g-1)+"px"}):v.css({width:y*g+u*(g-1)+"px",height:m.item(0).css("height")});var b=e.preCalcLoTs=[];for(i=0;i<g;i++){b[i]=[];for(j=1;j<g-1;j++)i==j?b[i][j]=t?j*c+j*u:j*c+j*u:b[i][j]=(j<=i?j*c:(j-1)*c+l)+j*u}m.each(function(i,a){a===0?i.css(d,"0px"):a==g-1?i.css(t?"bottom":"right","0px"):n?i.css(d,b[r][a]):i.css(d,a*y+a*u),n&&(r==a?(i.css(p,l+"px"),i.addClass(o)):i.css(p,c+"px")),i.css({margin:0,position:"absolute"}),i.on(s,function(){e.switchTo(a)})}),e.start()},destructor:function(){self.timer&&(self.timer.cancel(),self.timer=null,self.kwicks=null)}}),e.augment(n,n.METHOD),n},{requires:["brix/core/brick"]});