KISSY.add("brix/gallery/searchbox/index",function(a,b,c){function h(){h.superclass.constructor.apply(this,arguments)}var d=c.all,e=a.DOM,f=a.Event,g=0;return h.ATTRS={menuItems:{value:{}},menuItemsCount:{value:{}},prex:{value:"bx-searchbox-"},el:{value:"body"}},h.DOCATTACH={".searchbox-menu":{mouseenter:function(a){a.preventDefault();var b=this,c=a.currentTarget,d=e.parent(c,".J_searchbox"),f=e.get(".s-menu-container",c),g=e.get(".s-menu-list",c),h=d.id,i=b.get("menuItemsCount")[h];e.addClass(c,"expand"),e.height(f,24*i+13),e.height(g,24*i+10),e.addClass(e.get(".searchbox-inner",d),"expandmenu");var j=e.get(".searchbox-outer",d);e.hasClass(j,"focus")||e.addClass(j,"focus")},mouseleave:function(a){a.preventDefault();var b=this,c=a.currentTarget;b._collapse(c)}},".searchbox-input":{focus:function(a){var b=a.currentTarget,c=e.parent(b,".J_searchbox"),d=e.get(".searchbox-outer",c);e.hasClass(d,"focus")||e.addClass(d,"focus"),e.addClass(e.prev(b),"hide")},blur:function(a){var b=a.currentTarget;b.value===""&&e.removeClass(e.prev(b),"hide");var c=e.parent(b,".J_searchbox"),d=e.get(".searchbox-outer",c),f=e.get(".searchbox-menu",c);e.hasClass(d,"focus")&&!e.hasClass(f,"expand")&&e.removeClass(d,"focus")},keyup:function(a){console.log(1);var b=this,c=a.currentTarget,d=e.parent(c,".J_searchbox");b._dealClearBtn(c,d)},keydown:function(a){a.keyCode==13&&a.halt(!0)}},".search-label":{click:function(a){var b=a.currentTarget;f.fire(e.next(b),"focus")}},".s-btn-clear":{click:function(a){var b=this,c=a.currentTarget,d=e.parent(c,".J_searchbox"),f=e.get(".searchbox-input",d);e.val(f,""),b._hideBtn(c),f.focus()}}},h.METHOD={_collapse:function(a){var b=e.parent(a,".J_searchbox"),c=e.get(".s-menu-container",a),d=e.get(".s-menu-list",a);e.removeClass(a,"expand"),e.height(c,0),e.height(d,0),e.removeClass(e.get(".searchbox-inner",b),"expandmenu")},_dealClearBtn:function(a,b){var c=e.get(".s-btn-clear",b);a.value!==""?this._showBtn(c):this._hideBtn(c)},_dealLabel:function(a){var b=e.prev(a);a.value===""?e.removeClass(b,"hide"):e.addClass(b,"hide")},_hideBtn:function(a){e.removeClass(a,"btn-show"),e.addClass(a,"btn-hide")},_showBtn:function(a){e.removeClass(a,"btn-hide"),e.addClass(a,"btn-show")},_createSearchboxId:function(){return this.get("prex")+ ++g}},a.extend(h,b,{initialize:function(){var b=this,c=e.query(".J_searchbox");for(var d=0;d<c.length;d++){var g=c[d];g.id=b._createSearchboxId();var h=e.get(".searchbox-menu",g),i=e.query("li",h).length;b.get("menuItemsCount")[g.id]=i;var j=e.get(".searchbox-input",g);b._dealClearBtn(j,g),b._dealLabel(j)}console.log(b.get("menuItemsCount")),a.UA.ie&&a.UA.ie==6&&f.delegate("html","mouseenter mouseleave",".bx-tips-close",function(a){a.type==="mouseenter"?e.addClass(a.currentTarget,"hover"):e.removeClass(a.currentTarget,"hover")})},destructor:function(){}}),a.augment(h,h.METHOD),h},{requires:["brix/core/brick","node"]});