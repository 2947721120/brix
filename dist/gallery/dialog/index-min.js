KISSY.add("brix/gallery/dialog/index",function(a,b,c){function d(b){var c=this;d.superclass.constructor.apply(this,arguments);var c=this,e=a.one(c.get("trigger"));if(e){var f=c.get("triggerType");a.each(f,function(a){e.on(a,function(a){a.preventDefault(),c.toggle()})})}}return d.ATTRS={trigger:{value:!1},triggerType:{value:["click"]},start:{value:{left:600,top:100,opacity:0}},end:{value:{left:100,top:100,opacity:1}},x:{getter:function(){var a=this;return a.get("start").left}},y:{getter:function(){var a=this;return a.get("start").top}},dir:{getter:function(){var a=this,b="",c=a.get("start"),d=a.get("end");return c.left===d.left&&c.top===d.top?!1:(b=c.left===d.left&&(c.top<d.top?"down":"up")||c.top===d.top&&(c.left<d.left?"right":"left")||"left",b)}},elCls:{value:"dialog"},prefixCls:{value:"dialog-"},duration:{value:.3},easing:{value:"easeNone"},closable:{value:!0},mask:{value:!1},tmpl:{value:null},data:{}},a.extend(d,c,{initializer:function(){var a=this;a.on("afterRenderUI",function(){var c=a.get("el").one(".dialog-ext-close");c.one(".dialog-ext-close-x").html("&#223"),c.on("mouseenter",function(a){c.one(".dialog-ext-close-x").html("&#378")}),c.on("mouseleave",function(a){c.one(".dialog-ext-close-x").html("&#223")}),a.get("tmpl")&&(a.pagelet=new b({container:a.get("contentEl"),autoRender:!0,tmpl:a.get("tmpl"),data:a.get("data")}),a.pagelet.addBehavior())})},_visibilityChange:function(b,c){var d=this,e=d.get("el"),f=a.one("body"),g=a.one("html"),h="start",i=d.get("dir");e.stop(),e.css("visibility","visible"),b?(e.css(d.get("start")),h="end"):(e.css(d.get("end")),h="start"),f.css({width:f.width(),height:f.height(),overflow:"hidden"}),g.css({width:f.width(),height:f.height(),overflow:"hidden"}),e.animate(d.get(h),d.get("duration"),d.get("easing"),function(){e.css("visibility",b?"visible":"hidden"),b||e.css({left:"-99999px",top:"-99999px"}),f.css({width:"",height:"",overflow:""}),g.css({width:"",height:"",overflow:""}),c&&c.call(d)})},bindUI:function(){var a=this,b=a.get("el");a.on("beforeVisibleChange",function(c){var d=c.newVal,e=a.get("dir");b.removeClass("dialog-left").removeClass("dialog-right").removeClass("dialog-up").removeClass("dialog-down"),e&&b.addClass("dialog-"+e);if(!d)return a._visibilityChange(d,function(){b.css("visibility","hidden"),a.set("visible",!1,{silent:!0}),a.fire("hide")}),!1}),a.on("afterVisibleChange",function(b){var c=b.newVal;c&&a._visibilityChange(c)})},destructor:function(){var a=this;a.pagelet&&(a.pagelet.destroy(),a.pagelet=null)},toggle:function(){var a=this,b=a.get("el");b?b.css("visibility")=="hidden"?a.show():a.hide():a.show()}}),d},{requires:["brix/core/pagelet","overlay","./dialog.css"]});