KISSY.add("brix/gallery/dialog/index",function(e,t,n){function r(t){var n=this;r.superclass.constructor.apply(this,arguments);var n=this,i=e.one(n.get("trigger"));if(i){var s=n.get("triggerType");e.each(s,function(e){i.on(e,function(e){e.preventDefault(),n.toggle()})})}}return r.ATTRS={trigger:{value:!1},triggerType:{value:["click"]},start:{value:{left:600,top:100,opacity:0}},end:{value:{left:100,top:100,opacity:1}},x:{getter:function(){var e=this;return e.get("start").left}},y:{getter:function(){var e=this;return e.get("start").top}},dir:{getter:function(){var e=this,t="",n=e.get("start"),r=e.get("end");return n.left===r.left&&n.top===r.top?!1:(t=n.left===r.left&&(n.top<r.top?"down":"up")||n.top===r.top&&(n.left<r.left?"right":"left")||"left",t)}},elCls:{value:"dialog"},prefixCls:{value:"dialog-"},duration:{value:.3},easing:{value:"easeNone"},closable:{value:!0},mask:{value:!1},tmpl:{value:null},data:{}},e.extend(r,n,{initializer:function(){var e=this;e.on("afterRenderUI",function(){var n=e.get("el").one(".dialog-ext-close");n.one(".dialog-ext-close-x").html("&#223"),n.on("mouseenter",function(e){n.one(".dialog-ext-close-x").html("&#378")}),n.on("mouseleave",function(e){n.one(".dialog-ext-close-x").html("&#223")}),e.get("tmpl")&&(e.pagelet=new t({container:e.get("contentEl"),autoRender:!0,tmpl:e.get("tmpl"),data:e.get("data")}),e.pagelet.addBehavior())})},_visibilityChange:function(t,n){var r=this,i=r.get("el"),s=e.one("body"),o=e.one("html"),u="start",a=r.get("dir");i.stop(),i.css("visibility","visible"),t?(i.css(r.get("start")),u="end"):(i.css(r.get("end")),u="start"),s.css({width:s.width(),height:s.height(),overflow:"hidden"}),o.css({width:s.width(),height:s.height(),overflow:"hidden"}),i.animate(r.get(u),r.get("duration"),r.get("easing"),function(){i.css("visibility",t?"visible":"hidden"),t||i.css({left:"-99999px",top:"-99999px"}),s.css({width:"",height:"",overflow:""}),o.css({width:"",height:"",overflow:""}),n&&n.call(r)})},bindUI:function(){var e=this,t=e.get("el");e.on("beforeVisibleChange",function(n){var r=n.newVal,i=e.get("dir");t.removeClass("dialog-left").removeClass("dialog-right").removeClass("dialog-up").removeClass("dialog-down"),i&&t.addClass("dialog-"+i);if(!r)return e._visibilityChange(r,function(){t.css("visibility","hidden"),e.set("visible",!1,{silent:!0}),e.fire("hide")}),!1}),e.on("afterVisibleChange",function(t){var n=t.newVal;n&&e._visibilityChange(n)})},destructor:function(){var e=this;e.pagelet&&(e.pagelet.destroy(),e.pagelet=null)},toggle:function(){var e=this,t=e.get("el");t?t.css("visibility")=="hidden"?e.show():e.hide():e.show()}}),r},{requires:["brix/core/pagelet","overlay"]});