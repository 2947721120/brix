KISSY.add("touchswip",function(){function e(e,t){var i={min_move_x:20,min_move_y:20,wipeLeft:function(){},wipeRight:function(){},wipeUp:function(){},wipeDown:function(){},preventDefaultEvents:!0};t&&(i=KISSY.merge(i,t)),e.each(function(){function e(){o.removeEventListener("touchmove",t),n=null,s=!1}function t(t){if(i.preventDefaultEvents&&t.preventDefault(),s){var a=t.touches[0].pageX,l=t.touches[0].pageY,c=n-a,d=r-l;Math.abs(c)>=i.min_move_x?(e(),c>0?i.wipeLeft(t,o):i.wipeRight(t,o)):Math.abs(d)>=i.min_move_y&&(e(),d>0?i.wipeDown(t,o):i.wipeUp(t,o))}}function a(e){1==e.touches.length&&(n=e.touches[0].pageX,r=e.touches[0].pageY,s=!0,o.addEventListener("touchmove",t,!1))}var n,r,o=this[0],s=!1;"ontouchstart"in document.documentElement&&o.addEventListener("touchstart",a,!1)})}return e},{requires:["event"]}),KISSY.add("brix/gallery/property/index",function(e,t,i,a,n){var r=e.DOM,o="";o+="<li class='pf-slide-item pf-slide-item-{{id}}' filterid='{{id}}' filtertype='pf-{{id}}' filtername='{{name}}'>",o+="    <div class='pf-content'>",o+="        <div class='filter-title'>{{name}}</div>",o+="        {{#hasImage}}",o+="        <div class='filter-items pf-image pf-fixed-height clear-fix'>",o+="            {{#imgitems}}",o+="            <a data-stat='{{stat}}' href='{{url}}' class='filter-item fp-item-{{id}} pf-image-item' filterid='{{id}}' filtername='{{name}}' title='{{name}}'>",o+="                <img src='{{image}}'>",o+="            </a>",o+="            {{/imgitems}}",o+="        </div>",o+="        {{/hasImage}}",o+="        {{#hasGroupNoImage}}",o+="        <div class='filter-items pf-fixed-height clear-fix pf-itemcotainer-{{id}}'>",o+="            {{#items}}",o+="                <a data-stat='{{stat}}' href='{{url}}' class='filter-item fp-item-{{id}}' filterid='{{id}}' filtername='{{name}}' title='{{name}}'>{{name}}</a>",o+="            {{/items}}",o+="        </div>",o+="        {{/hasGroupNoImage}}",o+="        {{#hasgroup}}",o+="        <div id='pf-band-cate' class='pf-band-more pf-switch'>",o+="            <ul class='ks-switchable-nav'>",o+="                {{#cate}}",o+="                <li>{{group_name}}<i class='iconfont'>&#404;</i></li>",o+="                {{/cate}}",o+="            </ul>",o+="           <div class='ks-switchable-content'>",o+="               {{#cate}}",o+="               <div style='display: none'>",o+="                   <div class='pf-switch-ul clear-fix pf-itemcotainer-{{id}}'>",o+="                       {{#items}}",o+="                           <a data-stat='{{stat}}' href='{{url}}' class='filter-item fp-item-{{id}}' filterid='{{id}}' filtername='{{name}}' title='{{name}}'>{{name}}</a>",o+="                       {{/items}}",o+="                   </div>",o+="               </div>",o+="               {{/cate}}",o+="            </div>",o+="        </div>",o+="        {{/hasgroup}}",o+="        {{^hasgroup}}",o+="        <div class='filter-items clear-fix pf-itemcotainer-{{id}}'>",o+="            {{#items}}",o+="                <a data-stat='{{stat}}' href='{{url}}' class='filter-item fp-item-{{id}}' filterid='{{id}}' filtername='{{name}}' title='{{name}}'>{{name}}</a>",o+="            {{/items}}",o+="        </div>",o+="        {{/hasgroup}}",o+="    </div>",o+=" </li>";var s="";s+="{{#items}}",s+="    <a data-stat='{{stat}}' href='{{url}}' class='filter-item newadded fp-item-{{id}}' filterid='{{id}}' filtername='{{name}}' title='{{name}}'>{{name}}</a>",s+="{{/items}}";var l="";l+="    <div class='pf-st-slide'>",l+="        <div class='pf-st-wrap'>",l+="            {{#fp_cate}}",l+="            <span class='pf-st-item pf-{{id}}' filterid='{{id}}'>",l+="                {{#selectlist}}",l+="                <a href='{{url}}' class='selected-item pf-selid-{{id}}' filterid='{{id}}' filtername='{{name}}'>{{name}}<span class='del-btn'></span></a>",l+="                {{/selectlist}}",l+="            </span>",l+="            {{/fp_cate}}",l+="            {{#otherSelect}}",l+="            <span class='pf-st-item pf-other' filterid='other'>",l+="                <a href='{{url}}' class='selected-item pf-selid-{{type}} {{type}}-item' filterid='{{type}}' filtername='{{name}}'>{{name}}<span class='del-btn'></span></a>",l+="            </span>",l+="            {{/otherSelect}}",l+="            <a href='{{allurl}}' class='pf-st-clearall'><span>\u6e05\u9664\u5168\u90e8</span></a>",l+="        </div>",l+="    </div>",l+="    <a href='#' class='pf-st-indicator pf-st-prev'></a>",l+="    <a href='#' class='pf-st-indicator pf-st-next'></a>";var c=t.extend({bindUI:function(){this.initSlide(),this.initSelected(),this.registerTouchEvent(),this.getTemplate()},setAjaxData:function(e){this.setData(e)}});return c.ATTRS={mode:{value:1},templatePath:{cate:"components/property/template-cate.html",item:"components/property/template-item.html"},template:{cate:"",item:""},isCssAnim:!1,objMap:null,ajaxtimeout:null,data:{},curLink:"",containerWidth:0,minHeight:105,maxHeight:280,slideNum:0,slidePageNum:0,slidePerPage:0,slideDefaultWidth:280},c.METHODS={getTemplate:function(){c.ATTRS.template.cate=o,c.ATTRS.template.item=s,c.ATTRS.template.selected=l},updateUrl:function(t){var i=KISSY.clone(t.fp_cate);for(var a in i){var n=i[a];for(var r in n.items){var o=n.items[r],s=e.one(".fp-item-"+o.id);s&&s.length>0&&s.attr("href",o.url).attr("data-stat",o.stat)}for(var l in n.selectlist){var c=n.selectlist[l],s=e.one(".pf-selid-"+c.id);s&&s.length>0&&s.attr("href",c.url)}}},mergeData:function(t){function i(){var t={};for(var i in l){var a=e.one(".pf-slide-item-"+l[i].id);(null==a||0==a.length)&&(t[l[i].sort]=l[i],delete l[i])}return t}function a(){for(var t=o.getObjMap(),i=t.pfSlideItem,a=0;i.length>a;a++){var n=e.one(i[a]);void 0==l[n.attr("filterid")]&&(n.addClass("pf-deleteCate"),delete l[n.attr("filterid")])}return""}function n(){function t(t){var a=t.id;i[a]={items:[]};for(var n in t.items){var r=t.items[n],o=e.one("#J_propertyFilter .pf-itemcotainer-"+a+" .fp-item-"+r.id);null==o&&i[a].items.push(r)}}var i={};for(var a in l){var n=l[a];if(n.cate)for(var r in n.cate)t(n.cate[r]);n.items&&t(n)}return i}function r(){var t={};for(var i in l){var a=l[i];if(a.cate)for(var n in a.cate){var r=a.cate[n].items;for(var o in r){var s=r[o];t[s.id]=s}}if(a.imgitems)for(var c in a.imgitems){var s=a.imgitems[c];t[s.id]=s}if(a.items)for(var d in a.items){var s=a.items[d];t[s.id]=s}}for(var u=e.all(".filter-item"),p=0;u.length>p;p++){var f=e.one(u[p]);void 0==t[f.attr("filterid")]&&f.addClass("pf-deleteItem")}return""}var o=this,s=KISSY.clone(t.fp_cate),l={};for(var c in s)l[s[c].id]=s[c];var d={addCate:{fp_cate:i()},deleteCate:a(),additem:n(),deleteitem:r()};return d},getQueryParam:function(){return window.location.href},getPPath:function(){var t=e.all("#J_propertyFilter .filter-item.selected"),i={};t.each(function(){var t=e.one(e.DOM.parent(this,".pf-slide-item")).attr("filterid");3e4==t||(void 0==i[t]?i[t]=this.attr("filterid"):i[t]+=","+this.attr("filterid"))});var a="";for(var n in i)a+=n+":"+i[n]+";";return a.substring(0,a.length-1)},sendAjax:function(){return this.setAnchor(),void 0},setData:function(t){function n(t){if(t&&t.addCate&&t.addCate.fp_cate){var n=!0;e.one("#pf-band-cate")&&e.one("#pf-band-cate").length>0&&(n=!1);var o=t.addCate.fp_cate;for(var s in o){var l=a.to_html(c.ATTRS.template.cate,o[s]),d=e.one("#J_propertyFilter .pf-slide-item:eq("+(s-1)+")");if(d){var p=r.create(l);e.one(p).addClass("new-slide-item"),e.DOM.insertBefore(p,d[0])}else e.one(".pf-slide").append(l)}var f=e.all(".pf-slide-item");if(f.removeClass("new-slide-item"),u.animateFunc(f,{"margin-left":0},function(){}),u.calWidth(),n&&e.one("#pf-band-cate")&&e.one("#pf-band-cate").length>0){var h=i.Tabs;new h("#pf-band-cate",{triggerType:"click",switchTo:0})}}}function o(){u.animateFunc(e.all(".pf-deleteCate"),{opacity:0,"margin-left":-e.all(".pf-deleteCate").width()},function(e){e.remove(),u.calWidth()})}function s(t){for(var i in t.additem)if(0!=t.additem[i].items.length){var n=a.to_html(c.ATTRS.template.item,t.additem[i]);e.one(".pf-itemcotainer-"+i).append(n)}var r=e.all(".filter-item.newadded").length;u.animateFunc(e.all(".filter-item.newadded"),{"margin-left":20},function(t){if(t.removeClass("newadded"),0==--r){var i=e.one(".pf-slide-item.norelative");i&&i[0]&&u.showMore(i[0])}})}function l(){u.animateFunc(e.all(".pf-deleteItem:not(.pf-image-item)"),{opacity:0,"margin-left":-50},function(t){t.remove();var i=e.one(".pf-slide-item.norelative");i&&i[0]&&u.showMore(i[0])})}function d(){var t=a.to_html(c.ATTRS.template.selected,p);e.one(".pf-selected").html(t);var i=u.getObjMap(!0);e.one(".pf-st-slide").css("width",i.pfPanel.width()-100),u.checkSelectedStatus(!0)}var u=this,p=KISSY.JSON.parse(t);if(0!=p.fp_cate.length){this.updateUrl(p);var f=this.mergeData(p);n(f),o(),s(f),l(),d()}},setAnchor:function(){return},getPfHeight:function(){var e=c.ATTRS.minHeight,t=this.getObjMap();return"none"!=t.pfSelected.css("display")&&(e+=t.pfSelected.outerHeight()+parseInt(t.pfSelected.css("padding-top"))),e},getObjMap:function(t){return(null==c.ATTRS.objMap||t)&&(c.ATTRS.objMap={pfObj:e.one("#J_propertyFilter"),pfSlideItem:e.all(".pf-slide-item"),pfSelectedItem:e.all(".selected-item"),pfReplaceObj:e.one(".pf-replace"),pfWrapObj:e.one("#J_propertyFilter .contentwrap"),flushingSlide:e.one("#J_propertyFilter .flushingSlide"),pfPanelWrap:e.one("#J_propertyFilter .pf-panel-wrap"),pfPanel:e.one("#J_propertyFilter .pf-panel"),pfSelected:e.one("#J_propertyFilter .pf-selected"),pfclearAll:e.one("#J_propertyFilter .pf-st-clearall"),pfPagination:e.one("#J_propertyFilter .pf-pagination"),pfShadow:e.one("#J_propertyFilter .pf-shadow"),indicator:e.all("#J_propertyFilter .pagi-indicator")}),c.ATTRS.objMap},bindFixedEvent:function(){function t(){return e.one("#J_propertyFilter").hasClass("property-fixed")?!0:!1}var i=this;e.Event.delegate("#J_propertyFilter","mouseenter",".pf-selected",function(){t()&&!e.one("#J_propertyFilter").hasClass("hover")&&i.fixedMouseEnter()}),e.Event.delegate("#J_propertyFilter","mouseenter",".flushingSlide",function(){t()&&i.fixedMouseEnter()}),e.Event.on("#J_propertyFilter","mouseleave",function(){t()&&i.fixedMouseLeave()})},fixedShow:function(){function t(){var t=n.pfObj.offset().left;n.pfReplaceObj.height(parseInt(n.pfObj.height())+parseInt(n.pfObj.css("margin-bottom"))).show(),n.pfObj.css({width:e.one(".wrap").width()-t+e.one(".wrap").offset().left}),n.pfObj.addClass("property-fixed"),e.UA.ie&&6==e.UA.ie&&n.pfObj.css("top",e.one(window).scrollTop()),c.ATTRS.isCssAnim&&n.pfWrapObj.css("overflow","hidden"),a.animateFunc(n.pfWrapObj,{height:24},function(){i()})}function i(){n.pfPanel.hide(),n.indicator.addClass("hide");var t=n.pfSelectedItem;t.length>0?(n.pfPagination.show(),n.pfSelected.addClass("show"),n.flushingSlide.hide()):(n.pfPagination.hide(),n.pfSelected.removeClass("show"),n.flushingSlide.show()),n.pfObj.removeClass("hover"),n.pfShadow.show();var i=e.all("#J_propertyFilter .pf-flush-item");a.animateFunc(i,{width:i.attr("oriwidth")},function(){},.05)}var a=this,n=this.getObjMap();t()},fixedHide:function(){function t(){a.pfReplaceObj.hide(),a.pfObj.removeClass("property-fixed"),a.pfObj.css({left:"auto",width:"auto"}),e.UA.ie&&6==e.UA.ie&&(a.pfObj.css("top",0),a.pfObj[0].offsetLeft),0==a.pfSelectedItem.length&&a.pfSelected.removeClass("show"),i.animateFunc(a.pfWrapObj,{height:i.getPfHeight()},function(){a.pfPanel.show(),a.indicator.removeClass("hide"),a.flushingSlide.hide()})}var i=this,a=this.getObjMap();a.pfObj.stop(!0),a.pfWrapObj.stop(!0),a.pfObj.hasClass("property-fixed")&&t()},fixedMouseEnter:function(){var t=this,i=this.getObjMap(),a=e.all("#J_propertyFilter .pf-flush-item");this.animateFunc(a,{width:parseInt(a.attr("oriwidth"))+100},function(){i.pfObj.addClass("hover"),i.flushingSlide.hide(),i.indicator.removeClass("hide"),i.pfShadow.hide(),i.pfPanel.show(),"block"==i.pfSelected.css("display")&&i.pfPagination.show(),t.animateFunc(i.pfWrapObj,{height:t.getPfHeight()},function(){i.pfWrapObj.css("overflow","visible")})},.05)},fixedMouseLeave:function(){this.fixedShow()},selfAnimateHeight:function(t,i,a,n){var r=!1;c.ATTRS.isCssAnim&&t[0]&&t[0].style&&"webkitTransition"in t[0].style&&(r=!0);var o=!1,s=this;if(e.UA.ie&&6==e.UA.ie)t.height(i),n(t);else if(r)e.Event.detach(t,"webkitTransitionEnd"),e.Event.on(t,"webkitTransitionEnd",function(){return n(t),e.Event.detach(t,"webkitTransitionEnd"),!1}),t.height(i);else if(o){var l,d=20,u=i-t.height(),p=u/a;l=setInterval(function(){var e=t.height()+p*d;u>0&&i>e?t.height(e):0>u&&e>i?t.height(e):(t.height(i),clearInterval(l),n(t))},d)}else s.animateFunc(t,{height:i},function(){n(t)},a/1e3)},checkSelectedStatus:function(e){var t=this,i=t.getObjMap(!0);if(i.pfSelectedItem.length>0?("none"==i.pfSelected.css("display")?(i.pfSelected.addClass("show"),i.pfclearAll.addClass("show"),i.pfPagination.show(),t.selfAnimateHeight(i.pfSelected,34,200,function(){}),t.selfAnimateHeight(i.pfWrapObj,c.ATTRS.minHeight+34,200,function(){})):(i.pfclearAll.addClass("show"),i.pfPagination.show()),t.setSelIndicatorSt()):(i.pfclearAll.removeClass("show"),i.pfPagination.hide(),t.selfAnimateHeight(i.pfWrapObj,c.ATTRS.minHeight,200,function(){i.pfSelected.removeClass("show")}),t.selfAnimateHeight(i.pfSelected,0,200,function(){i.pfSelected.removeClass("show")})),!e){var a=!1;a?(clearTimeout(c.ATTRS.ajaxtimeout),c.ATTRS.ajaxtimeout=setTimeout(function(){t.sendAjax()},300)):t.sendAjax()}},setSelectedStyle:function(){var t=e.all("#J_propertyFilter .selected-item");if(t.length>0)for(var i=0;t.length>i;i++){var a=e.one(t[i]).attr("filterid");e.all("#J_propertyFilter .fp-item-"+a).addClass("selected")}},setSelIndicatorSt:function(){var t=e.one(".pf-st-slide"),i=e.one(".pf-st-clearall"),a=t.offset().left+t.width(),n=t.scrollLeft(),r=i.width()+i.offset().left;r>a?e.one(".pf-st-next").show():e.one(".pf-st-next").hide(),n>0?e.one(".pf-st-prev").show():e.one(".pf-st-prev").hide()},getCurSelWidth:function(){var e=this,t=e.getObjMap(),i=t.pfSelectedItem,a=0;return i.each(function(){a+=this[0].offsetWidth+10}),a+150},initSelected:function(){function t(t,i,n,o){a.getObjMap();var s=r.children(".pf-st-wrap","."+t);e.all(".fp-item-"+i).addClass("selected");var l='<a href="#" style="margin-left:-50px;" class="selected-item pf-selid-'+i+'" filterid="'+i+'" filtername="'+n+'" title="'+n+'">'+n+'<span class="del-btn"></span></a>';"pf-30000"==t&&(l='<a href="#" link="'+o.attr("href")+'" style="margin-left:-50px;" class="selected-item priceRange-item pf-selid-'+i+'" filterid="'+i+'" filtername="'+n+'" title="'+n+'">'+n+'<span class="del-btn"></span></a>'),e.one(".pf-st-wrap").width(a.getCurSelWidth()+30*n.length),e.one(s).prepend(l),a.getObjMap(!0),a.checkSelectedStatus(!0),a.animateFunc(e.one(".pf-selid-"+i),{"margin-left":0},function(t){t.css({opacity:1}),a.checkSelectedStatus(),e.one(".pf-st-wrap").width(a.getCurSelWidth())})}function i(t){e.all(".fp-item-"+t).removeClass("selected");var i=e.one(".pf-selid-"+t);i.css("z-index",0),a.animateFunc(i,{"margin-left":-(i.width()+35)},function(t){t.remove(),a.getObjMap(!0),e.one(".pf-st-wrap").width(a.getCurSelWidth()),a.checkSelectedStatus()},.3)}var a=this,n=a.getObjMap();e.Event.delegate("#J_propertyFilter","click",".filter-item",function(n){var o=e.one(n.target),s=r.parent(n.target,".pf-slide-item");o.hasClass("filter-item")||(o=o.parent(".filter-item")),c.ATTRS.curLink=o.attr("href");var l=e.one(s).attr("filtertype"),d=e.one(s).attr("filterid"),u=o.attr("filterid"),p=o.attr("filtername");return o.hasClass("selected")?i(u):(t(l,u,p,o),"30000"==d&&a.animateFunc(e.one(".pf-slide-item-30000"),{opacity:0,"margin-left":-e.all(".pf-slide-item-30000").width()},function(e){e.remove(),a.calWidth()},.3)),!1}),e.Event.delegate("#J_propertyFilter","click",".selected-item",function(t){c.ATTRS.curLink=t.target.href;var a=e.one(t.target);a.hasClass("selected-item")||(a=e.one(r.parent(t.target,".selected-item")));var n=a.attr("filterid");return i(n),!1}),e.Event.delegate("#J_propertyFilter","mouseenter",".selected-item",function(t){n.pfSelectedItem.removeClass("hover"),e.one(t.target).addClass("hover")}),e.Event.delegate("#J_propertyFilter","mouseleave",".selected-item",function(t){e.one(t.target).removeClass("hover")}),e.Event.delegate("#J_propertyFilter","click",".pf-st-clearall",function(t){var i=e.one(t.target);return i.hasClass("pf-st-clearall")||(i=i.parent(".pf-st-clearall")),c.ATTRS.curLink=i.attr("href"),e.all(".filter-item").removeClass("selected"),a.animateFunc(e.all(".selected-item"),{"margin-left":-70},function(e){e.remove(),a.checkSelectedStatus()},.3),!1}),e.Event.delegate("#J_propertyFilter","click",".pf-st-prev",function(){var t=e.one(".pf-st-slide"),i=t.width();return e.one(".pf-st-wrap").width(a.getCurSelWidth()),a.animateFunc(t,{scrollLeft:t.scrollLeft()-i},function(){a.setSelIndicatorSt()},.6),!1}),e.Event.delegate("#J_propertyFilter","click",".pf-st-next",function(){var t=e.one(".pf-st-slide"),i=t.width();return e.one(".pf-st-wrap").width(a.getCurSelWidth()),a.animateFunc(t,{scrollLeft:t.scrollLeft()+i},function(){a.setSelIndicatorSt()},.6),!1}),a.setSelectedStyle(),a.checkSelectedStatus(!0)},removeDuplicate:function(){var t=e.all("#J_propertyFilter .pf-fixed-height:not(.pf-image) .filter-item");if(t)for(var i=0;t.length>i;i++)if(!(t[i].offsetTop>100)){var a=e.one(t[i]).attr("filterid"),n=e.one("#pf-band-cate .fp-item-"+a);n&&n.addClass("hidden")}},initSlide:function(){if("webkitTransition"in e.DOM.get("#J_propertyFilter").style&&(c.ATTRS.isCssAnim=!0),c.ATTRS.isCssAnim?e.one("#J_propertyFilter").addClass("useCssAnimate"):e.one("#J_propertyFilter").removeClass("useCssAnimate"),e.one("#pf-band-cate")&&e.one("#pf-band-cate").length>0){var t=i.Tabs;new t("#pf-band-cate",{triggerType:"click",switchTo:0})}var a=this;this.calWidth();var n=null;e.Event.on(window,"scroll",function(){clearTimeout(n),n=setTimeout(function(){var t=e.one(".main").offset().top,i=e.one(window).scrollTop();if(i>t){var n=a.getObjMap();if(e.UA.ie&&6==e.UA.ie);else if(n.pfObj.hasClass("property-fixed"))return;var r=e.DOM.get(".pf-slide-item.norelative");r&&a.hideMore(r),a.fixedShow()}else{var n=a.getObjMap();n.pfObj.hasClass("property-fixed")&&a.fixedHide()}},50)}),a.bindFixedEvent(),e.Event.delegate("#J_propertyFilter","click",".pf-pg-link",function(t){e.one(t.target).addClass("active").siblings().removeClass("active");var i=a.getObjMap(),n=i.pfPanel,r=i.pfSlideItem.width()*c.ATTRS.slidePerPage,o=r-(n.width()-r)/2;return a.animateFunc(n,{scrollLeft:o+r*(parseInt(e.one(t.target).attr("num"))-1)},function(){}),0==e.one(t.target).attr("num")?(e.one(".pagi-prev").removeClass("show"),e.one(".pagi-next").addClass("show")):e.one(t.target).attr("num")==c.ATTRS.slidePageNum-1?(e.one(".pagi-prev").addClass("show"),e.one(".pagi-next").removeClass("show")):(e.one(".pagi-prev").addClass("show"),e.one(".pagi-next").addClass("show")),!1}),e.Event.delegate("#J_propertyFilter","click",".pagi-prev",function(){var t=e.one(".pf-pg-link.active");t.prev()&&t.prev().fire("click")}),e.Event.delegate("#J_propertyFilter","click",".pagi-next",function(){var t=e.one(".pf-pg-link.active");t.next()&&t.next().fire("click")}),e.Event.on(".pf-content","click",function(){return}),e.Event.delegate("#J_propertyFilter","mouseenter",".pf-content",function(t){var i=r.parent(t.target,".pf-slide-item"),n=r.parent(t.target,".pf-panel");if(!e.one(i).hasClass("no-slidedown")){var o=i.offsetLeft,s=i.offsetLeft+i.offsetWidth,l=n.scrollLeft,c=n.scrollLeft+n.offsetWidth;o>=l&&c>=s&&a.showMore(i)}}),e.Event.delegate("#J_propertyFilter","mouseleave",".pf-content",function(e){a.hideMore(r.parent(e.target,".pf-slide-item"))}),e.Event.delegate("#J_propertyFilter","mouseenter",".ks-switchable-nav li",function(t){e.one(t.target).fire("click")}),a.removeDuplicate()},getpfContentHeight:function(e,t){var i=e.children(".filter-title").height(),a=0;e.children(".filter-items").each(function(){a+=this.height()});var n=i+a+t;return c.ATTRS.minHeight>=n?c.ATTRS.minHeight:n>=c.ATTRS.maxHeight?c.ATTRS.maxHeight:n},animateFunc:function(t,i,a,n){var r=!1;c.ATTRS.isCssAnim&&void 0==i.width&&void 0==i.scrollLeft&&(r=!0),e.UA.ie&&6==e.UA.ie?(i.scrollLeft&&(t.scrollLeft(i.scrollLeft),delete i.scrollLeft),t.css(i),a(t)):r?(e.Event.detach(t,"webkitTransitionEnd"),e.Event.on(t,"webkitTransitionEnd",function(){return e.Event.detach(t,"webkitTransitionEnd"),a(t),!1}),t.css(i)):(t.hasClass("property-fixed")?t.stop(!0):t.stop(!1),t.animate(i,{duration:n||.5,easing:"easeOutStrong",complete:function(){a(t)}}))},showMore:function(t){var i=this.getObjMap(),a=e.one(".pf-slide"),n=e.one(r.children(t,".pf-content")),o=n.children(".filter-items:not(.pf-fixed-height)"),s=n.children(".filter-items.pf-fixed-height"),l=o.height(),d=n.children(".pf-switch");o.removeClass("maxheight");var u=14,p=d&&d.length>0,f=s&&s.length>0;if(p&&f)u=300;else if(!p&&f)150>=l?o.css({height:"auto"}):(u=300,o.css({overflow:"auto",height:"158"}));else{if(80>=l)return;l>244&&o.addClass("maxheight")}i.pfWrapObj.css("overflow","visible"),n.css({width:e.one(t).width()-1,overflow:"hidden",left:parseInt(t.offsetLeft)}),e.one(t).addClass("norelative");var h=this.getpfContentHeight(n,u);i.pfPanelWrap.css("border-bottom","none"),this.animateFunc(a,{height:h+5},function(){}),c.ATTRS.isCssAnim?n.height(h-3):this.animateFunc(n,{height:h-3},function(){})},hideMore:function(t){if(e.one(t).hasClass("norelative")){var i=e.one(".pf-slide"),a=e.one(r.children(t,".pf-content")),n=a.children(".filter-items");n.removeClass("maxheight"),a.scrollTop(0),this.animateFunc(a,{height:c.ATTRS.minHeight},function(){a.css({width:"100%",overflow:"hidden",height:c.ATTRS.minHeight,left:0}),e.one(t).removeClass("norelative")}),this.animateFunc(i,{height:c.ATTRS.minHeight},function(){})}},calWidth:function(){var t=this.getObjMap(!0),i=t.pfPanel,a=t.pfSlideItem,n=e.one(".pf-slide"),o=e.one(".pf-st-slide");o.css("width",i.width()-100);var s=Math.floor(i.width()/c.ATTRS.slideDefaultWidth);s=a.length>s?s:a.length;var l=Math.ceil(a.length/s);if(i.width()!=c.ATTRS.containerWidth||a.length!=c.ATTRS.slideNum){if(c.ATTRS.slideNum=a.length,c.ATTRS.containerWidth=i.width(),1==l){n.width(i.width());var d=parseInt(i.width()/s);a.width(d),a.children(".pf-content").width(d),e.one("#pf-band-cate")&&e.one("#pf-band-cate").length>0&&this.hideMore(r.parent("#pf-band-cate",".pf-slide-item")),d>450&&e.one("#pf-band-cate")&&e.one("#pf-band-cate").parent(".pf-slide-item")&&e.one("#pf-band-cate").parent(".pf-slide-item").addClass("no-slidedown")}else n.width(a.length*c.ATTRS.slideDefaultWidth),a.width(c.ATTRS.slideDefaultWidth),a.removeClass("no-slidedown");c.ATTRS.slidePageNum=l,c.ATTRS.slidePerPage=s,this.animateFunc(i,{scrollLeft:0},function(){},1),this.generatePagition(l)}this.generateFlushItem()},generateFlushItem:function(){var t=this.getObjMap(),i="";t.pfSlideItem.each(function(t,a){if(5>a){var n=e.one(this).attr("filterid"),r=e.one(this).attr("filtername");i+='<span class="pf-flush-item pf-flush-item-'+n+'" filterid="'+n+'" filtertype="pf-'+n+'">'+r+"</span>"}}),t.flushingSlide.html(i);var a=e.all(".pf-flush-item"),n=parseInt((t.pfPanel.width()-30)/a.length);a.width(n),a.attr("oriwidth",n)},generatePagition:function(t){var i=this.getObjMap();if(i.indicator.removeClass("show"),1>=t)i.pfPagination.html("");else{e.one(".pagi-next").addClass("show");for(var a="",n=0;t>n;n++)a+='<a href="#" class="pf-pg-link '+(0==n?"active":"")+'" num="'+n+'">'+n+"</a>";i.pfPagination.html(a)}},registerTouchEvent:function(){if(!e.UA.ie||6!=e.UA.ie){var t=this.getObjMap();n(t.pfPanel,{wipeLeft:function(){KISSY.one("#J_propertyFilter .pagi-next").fire("click")},wipeRight:function(){KISSY.one("#J_propertyFilter .pagi-prev").fire("click")},wipeUp:function(){},wipeDown:function(){},min_move_x:20,min_move_y:20,preventDefaultEvents:!0})}}},c.EVENTS={"#J_unfold":{click:function(){}}},e.augment(c,c.METHODS),c},{requires:["brix/core/brick","switchable","brix/core/mustache","touchswip","../property/index.css"]});